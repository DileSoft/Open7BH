import{v as we,d as Y,a as Z,b as Ie,c as De,e as Ve,f as Ne,g as ke,h as Le,j as n,i as c,F as G,k as K,l as M,B as k,S as f,M as y,T as g,m as ee,I as H,n as ze,o as Te,p as Ee,s as Re,q as Oe,r as T,G as P,t as _,D as $e,u as Me,w as Fe,C as te,x as Ue,y as Ge,z as Pe,A as re,E as _e,R as Ae}from"./vendor.0a97c372.js";const He=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function l(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(s){if(s.ep)return;s.ep=!0;const i=l(s);fetch(s.href,i)}};He();var o;(function(r){r.Calc="calc",r.Pickup="pickup",r.Drop="drop",r.End="end",r.Foreach="foreach",r.EndForeach="endforeach",r.Give="give",r.Goto="goto",r.Hear="hear",r.If="if",r.EndIf="endif",r.Near="near",r.Say="say",r.Step="step",r.Take="take",r.Variable="variable",r.Write="write"})(o||(o={}));class C{constructor(e){this.level=e,this.id=we()}prepare(e){}remove(){}}var p;(function(r){r.Up="Up",r.Down="Down",r.Left="Left",r.Right="Right",r.UpLeft="UpLeft",r.UpRight="UpRight",r.DownLeft="DownLeft",r.DownRight="DownRight"})(p||(p={}));var m;(function(r){r.Up="Up",r.Down="Down",r.Left="Left",r.Right="Right",r.UpLeft="UpLeft",r.UpRight="UpRight",r.DownLeft="DownLeft",r.DownRight="DownRight",r.Here="Here"})(m||(m={}));var x;(function(r){r.Direction="Direction",r.Slot="Slot",r.Near="Near"})(x||(x={}));class le extends C{constructor(e){super(e);this.type=x.Direction,this.directions=[p.Down]}setDirection(e){this.type=x.Direction,this.directions=e}setSlot(e){this.type=x.Slot,this.slot=e}prepare(e){if(this.type===x.Direction){const l=We(this.directions);e.prepareMove(l)}if(this.type===x.Slot&&e.slots[this.slot].getCellValue()){const l=this.level.findNear([e.cell.x,e.cell.y],t=>t===e.slots[this.slot].getCellValue());console.log(e.slots[this.slot].getCellValue()),console.log(l),l.length>1&&l[1]&&(e.nextMove=l[1])}}execute(e){return this.type===x.Slot&&e.nextMove?e.currentLine:e.currentLine+1}serialize(e){return{type:o.Step,stepType:this.type,directions:this.directions,slot:this.slot,object:e?this:void 0}}deserialize(e){this.type=e.stepType,this.directions=e.directions,this.slot=e.slot}}const se=r=>r.split("x").map(e=>parseInt(e)),We=r=>r[Math.floor(Math.random()*r.length)],L=r=>{const l={[m.Left]:Y,[m.Right]:Z,[m.Up]:Ie,[m.Down]:De,[m.UpLeft]:Ve,[m.UpRight]:Ne,[m.DownLeft]:ke,[m.DownRight]:Le,[m.Here]:null}[r];return l?n(l,{fontSize:"small"}):null};class W{constructor(e,l,t,s){this.isRandom=!1,this.value=0,this.tag=null,this.value=e,this.isRandom=l,l&&(this.value=Math.floor(Math.random()*(s-t+1))+t)}setTag(e){this.tag=e}}var j;(function(r){r.Empty="empty",r.Wall="wall",r.Hole="hole",r.Printer="printer",r.Shredder="shredder"})(j||(j={}));class F{constructor(e,l,t){this.character=null,this.item=null,this.isEmpty=!1,this.level=e,this.x=l,this.y=t}getCharacter(){return this.character}setCharacter(e){this.isEmpty&&(e.cell&&(e.cell.character=null),this.character=e,e.cell=this)}getItem(){return this.item}setItem(e){this.item=e}removeItem(){this.item=null}}class ie{constructor(e){this.character=e}getNumberValue(){return 0}getCellValue(){}getCharacterValue(){}}class q extends ie{constructor(){super(...arguments);this.number=0}setNumber(e){this.number=e}getNumberValue(){return this.number}}class B extends F{constructor(e,l,t,s,i){super(e,l,t);this.isEmpty=!0,this.min=0,this.max=99,this.min=s||0,this.max=i||99}print(){return Math.floor(Math.random()*(this.max-this.min+1))+this.min}getType(){return j.Printer}}class J extends F{constructor(){super(...arguments);this.isEmpty=!0,this.shredded=0}getType(){return j.Shredder}shred(){this.shredded++}}class ne{constructor(e,l){this.color="green",this.item=null,this.isTerminated=!1,this.isDead=!1,this.slots=[],this.currentLine=0,this.operationDone=!1,this.cell=e,this.name=l;for(let t=0;t<4;t++)this.slots.push(new q(this))}prepareMove(e){this.nextMove=this.getMoveCell(e,!0)}prepare(){if(this.isTerminated||this.hear)return;const e=this.cell.level.game.code;if(this.currentLine>=e.length)return;e[this.currentLine].prepare(this)}update(){if(this.isTerminated)return;if(this.operationDone){this.operationDone=!1;return}if(this.hear)return;const e=this.cell.level.game.code;if(this.currentLine>=e.length)return;const l=e[this.currentLine];this.currentLine=l.execute(this),this.currentLine>=e.length&&(this.isTerminated=!0),this.operationDone=!1}setItem(e){this.item=e}giveItem(e){const l=this.cell.level.getMoveCell(this.cell.x,this.cell.y,e);l&&l.character&&!l.character.item&&this.item&&(l.character.setItem(this.item),l.character.operationDone=!0,this.item=null),l&&l instanceof J&&this.item&&(l.shred(),this.item=null)}take(e){const l=this.cell.level.getMoveCell(this.cell.x,this.cell.y,e);l&&l instanceof B&&!this.item&&(this.item=new W(l.print()))}write(e){this.item&&(this.item.value=e)}pickupItem(){const e=this.cell.getItem();e&&!this.item&&(this.setItem(e),this.cell.removeItem())}dropItem(){this.item&&!this.cell.getItem()&&(this.cell.setItem(this.item),this.item=null)}getMoveCell(e,l=!1){const t=this.cell.level.getMoveCell(this.cell.x,this.cell.y,e);return t&&t.isEmpty&&(l||!t.character)?t:void 0}say(e,l){const t=this.cell.level.getMoveCell(this.cell.x,this.cell.y,l);t&&t.character&&t.character.hear===e&&(t.character.hear=null,t.character.currentLine++)}terminate(){this.isTerminated=!0}die(){this.isDead=!0,this.terminate(),this.cell.character=null}}class A extends F{constructor(){super(...arguments);this.isEmpty=!0}getType(){return j.Empty}}class ae extends F{constructor(){super(...arguments);this.isEmpty=!0}getType(){return j.Hole}}class oe extends F{constructor(){super(...arguments);this.isEmpty=!0}getType(){return j.Wall}}class z{constructor(e){this.cells={},this.game=e}serialize(e){const l={task:this.task,width:this.width,height:this.height,cells:[],winCallback:this.winCallback,object:e?this:void 0};return Object.values(this.cells).forEach(t=>{const s=t.getCharacter();l.cells.push({x:t.x,y:t.y,type:t.getType(),character:s?{name:s.name,color:s.color,coordinates:[t.x,t.y],object:e?s:void 0}:null,item:t.getItem()?{isRandom:t.getItem().isRandom,value:t.getItem().value,tag:t.getItem().tag}:void 0,object:e?t:void 0})}),l}deserialize(e){this.task=e.task,this.width=e.width,this.height=e.height,this.winCallback=e.winCallback,e.cells.forEach(l=>{let t;l.type===j.Empty&&(t=new A(this,l.x,l.y)),l.type===j.Hole&&(t=new ae(this,l.x,l.y)),l.type===j.Printer&&(t=new B(this,l.x,l.y)),l.type===j.Shredder&&(t=new J(this,l.x,l.y)),l.type===j.Wall&&(t=new oe(this,l.x,l.y)),l.character&&t.setCharacter(new ne(t,l.character.name)),l.item&&(t.setItem(new W(l.item.value,l.item.isRandom)),l.item.tag&&(t.getItem().tag=l.item.tag)),this.addCell(l.x,l.y,t)})}addCharacter(e,l,t){this.getCell(l,t).setCharacter(e)}moveCharacters(){const e=this.getCharacters().filter(t=>t.nextMove),l=[...e];for(;l.length;)l.forEach(t=>{const s=t.nextMove;if(s&&!s.character){console.log(t.name,"move to empty"),t.cell.character=null,t.cell=s,s.character=t,l.splice(l.indexOf(t),1),t.nextMove=null;return}if(s&&s.character&&s.character.nextMove&&s.character.nextMove===t.cell){const i=t.cell,a=s.character.cell,u=t,h=s.character;i.character=h,a.character=u,u.cell=a,h.cell=i,l.splice(l.indexOf(t),1),l.splice(l.indexOf(s.character),1),u.nextMove=null,h.nextMove=null;return}s&&s.character&&!s.character.nextMove&&(console.log(t.name,"move to character",s.character.name),l.splice(l.indexOf(t),1),t.nextMove=null)});e.forEach(t=>{t.cell.getType()===j.Hole&&t.die()}),console.log(this.getCharacters().filter(t=>t.nextMove))}addCell(e,l,t){this.cells[`${e}x${l}`]=t}getCell(e,l){return this.cells[`${e}x${l}`]}getMoveCell(e,l,t){if(t===m.Here)return this.getCell(e,l);if(t===m.Up)return this.getCell(e,l-1);if(t===m.Down)return this.getCell(e,l+1);if(t===m.Left)return this.getCell(e-1,l);if(t===m.Right)return this.getCell(e+1,l);if(t===m.UpLeft)return this.getCell(e-1,l-1);if(t===m.UpRight)return this.getCell(e+1,l-1);if(t===m.DownLeft)return this.getCell(e-1,l+1);if(t===m.DownRight)return this.getCell(e+1,l+1)}getCharacters(){return Object.values(this.cells).map(e=>e.getCharacter()).filter(e=>e!==null)}findNear(e,l){const t=[],s={[`${e[0]}x${e[1]}`]:0};if(this.markNearRecursive(e,l,1,s,t),t.length){t.sort((a,u)=>s[a]-s[u]);const i=this.getPathRecursive(this.cells[t[0]],s);return i.reverse(),i}return[]}getPathRecursive(e,l={},t=[]){if(t.push(e),l[`${e.x}x${e.y}`]===0)return t;for(const s in Object.values(p)){const i=Object.values(p)[s],a=this.getMoveCell(e.x,e.y,i);if(a&&l[`${a.x}x${a.y}`]===l[`${e.x}x${e.y}`]-1)return this.getPathRecursive(a,l,t)}return t}markNearRecursive(e,l,t,s={},i=[]){if(this.cells[`${e[0]}x${e[1]}`])for(const a in Object.values(p)){const u=Object.values(p)[a],h=this.getMoveCell(e[0],e[1],u);if(!!h&&!(h.getType()!==j.Empty&&!l(h))&&!(s[`${h.x}x${h.y}`]!==void 0&&s[`${h.x}x${h.y}`]<=t)){if(s[`${h.x}x${h.y}`]=t,h&&l(h)){i.push(`${h.x}x${h.y}`);return}this.markNearRecursive([h.x,h.y],l,t+1,s,i)}}}changeSize(e,l){for(let t=0;t<e;t++)for(let s=0;s<l;s++)this.cells[`${t}x${s}`]||(this.cells[`${t}x${s}`]=new A(this,t,s));this.width=e,this.height=l}crop(e,l){Object.keys(this.cells).forEach(t=>{const s=t.split("x");(parseInt(s[0])>=e||parseInt(s[1])>=l)&&delete this.cells[t]}),this.width=e,this.height=l}}z.parseCells=(r,e)=>{const l=[];return r.split(/[\r\n]+/).forEach((t,s)=>{t.split(/ +/).forEach((i,a)=>{const u=i.split("|"),h={type:j.Empty,x:a,y:s,character:void 0};u[0]==="box"&&(h.item={value:parseInt(u[1]),isRandom:u[1]==="random"}),u[0]==="hole"&&(h.type=j.Hole),u[0]==="wall"&&(h.type=j.Wall),u[0]==="printer"&&(h.type=j.Printer),u[0]==="shredder"&&(h.type=j.Shredder);const D=e.find(d=>d.coordinates[0]===a&&d.coordinates[1]===s);D&&(h.character=D),l.push(h)})}),l};var E;(function(r){r.Add="+",r.Subtract="-",r.Multiply="*",r.Divide="/"})(E||(E={}));var b;(function(r){r.Number="number",r.Direction="direction",r.Slot="slot"})(b||(b={}));class qe extends C{constructor(){super(...arguments);this.operand1type=b.Number,this.operand1NumberValue=0,this.operand1DirectionValue=m.Up,this.operand1SlotValue=0,this.operator=E.Add,this.operand2type=b.Number,this.operand2NumberValue=0,this.operand2DirectionValue=m.Up,this.operand2SlotValue=0,this.slotResult=0}execute(e){var a,u,h,D;let l=0,t=0,s=0;this.operand1type===b.Number&&(l=this.operand1NumberValue),this.operand1type===b.Direction&&(l=((u=(a=this.level.getMoveCell(e.cell.x,e.cell.y,this.operand1DirectionValue))==null?void 0:a.item)==null?void 0:u.value)||0),this.operand2type===b.Number&&(t=this.operand2NumberValue),this.operand2type===b.Direction&&(t=((D=(h=this.level.getMoveCell(e.cell.x,e.cell.y,this.operand2DirectionValue))==null?void 0:h.item)==null?void 0:D.value)||0),this.operator===E.Add?s=l+t:this.operator===E.Subtract?s=l-t:this.operator===E.Multiply?s=l*t:this.operator===E.Divide&&(s=l/t);const i=new q(e);return i.setNumber(s),e.slots[this.slotResult]=i,e.currentLine+1}setOperand1Number(e){this.operand1type=b.Number,this.operand1NumberValue=e}setOperand1Direction(e){this.operand1type=b.Direction,this.operand1DirectionValue=e}setOperand1Slot(e){this.operand1type=b.Slot,this.operand1SlotValue=e}setOperand2Number(e){this.operand2type=b.Number,this.operand2NumberValue=e}setOperand2Direction(e){this.operand2type=b.Direction,this.operand2DirectionValue=e}setOperand2Slot(e){this.operand2type=b.Slot,this.operand2SlotValue=e}serialize(e=!1){return{type:o.Calc,operand1type:this.operand1type,operand1NumberValue:this.operand1NumberValue,operand1DirectionValue:this.operand1DirectionValue,operand1SlotValue:this.operand1SlotValue,operator:this.operator,operand2type:this.operand2type,operand2NumberValue:this.operand2NumberValue,operand2DirectionValue:this.operand2DirectionValue,operand2SlotValue:this.operand2SlotValue,slotResult:this.slotResult,object:e?this:void 0}}deserialize(e){this.operand1type=e.operand1type,this.operand1NumberValue=e.operand1NumberValue,this.operand1DirectionValue=e.operand1DirectionValue,this.operand1SlotValue=e.operand1SlotValue,this.operator=e.operator,this.operand2type=e.operand2type,this.operand2NumberValue=e.operand2NumberValue,this.operand2DirectionValue=e.operand2DirectionValue,this.operand2SlotValue=e.operand2SlotValue,this.slotResult=e.slotResult}}class ce extends C{execute(e){return e.dropItem(),e.currentLine+1}serialize(e){return{type:o.Drop,object:e?this:void 0}}deserialize(e){}}class he extends C{execute(e){return e.terminate(),e.currentLine}serialize(e){return{type:o.End,object:e?this:void 0}}deserialize(e){}}class Be extends C{execute(e){return e.currentLine+1}serialize(e){return{type:o.EndForeach,id:this.id,operatorForeach:this.operatorForeach.id,object:e?this:void 0}}deserialize(e){this.id=e.id,this.operatorForeach=this.level.game.code.find(l=>l.id===e.operatorForeach)}}class de extends C{constructor(){super(...arguments);this.directions=[],this.slotNumber=0}execute(e){return e.currentLine+1}createEndForeach(){const e=new Be(this.level);return e.operatorForeach=this,this.operatorEndForeach=e,e}setDirections(e){this.directions=e}serialize(e){return{type:o.Foreach,id:this.id,operatorEndForeach:this.operatorEndForeach.id,directions:this.directions,slotNumber:this.slotNumber,object:e?this:void 0}}deserialize(e){this.id=e.id,this.operatorEndForeach=this.level.game.code.find(l=>l.id===e.id),this.directions=e.directions,this.slotNumber=e.slotNumber}}class ue extends C{constructor(e){super(e);this.direction=p.Down}setDirection(e){this.direction=e}execute(e){return e.giveItem(this.direction),e.currentLine+1}serialize(e){return{type:o.Give,direction:this.direction,slot:this.slot,object:e?this:void 0}}deserialize(e){this.direction=e.direction,this.slot=e.slot}}class pe extends C{constructor(){super(...arguments);this.line=0}execute(e){return this.line}setLine(e){this.line=e}serialize(e){return{type:o.Goto,line:this.line,object:e?this:void 0}}deserialize(e){this.line=e.line}}class me extends C{execute(e){return e.hear=this.hear,e.currentLine+1}setHear(e){this.hear=e}serialize(e){return{type:o.Hear,hear:this.hear,object:e?this:void 0}}deserialize(e){this.hear=e.hear}}class Q extends ie{setCell(e){this.cellValue=e}getCellValue(){return this.cellValue}}class Je extends C{remove(){const e=this.level.game.code.findIndex(l=>l===this.operatorIf);this.level.game.code.splice(e,1)}execute(e){return e.currentLine+1}serialize(e){return{type:o.EndIf,id:this.id,operatorIf:this.operatorIf.id,object:e?this:void 0}}deserialize(e){this.id=e.id,this.operatorIf=this.level.game.code.find(l=>l.id===e.operatorIf)}}var w;(function(r){r.Eq="eq",r.Ne="ne",r.Gt="gt",r.Ge="ge",r.Lt="lt",r.Le="le"})(w||(w={}));var O;(function(r){r.And="and",r.Or="or"})(O||(O={}));var S;(function(r){r.Direction="direction",r.Number="number",r.Slot="slot",r.MyItem="myItem"})(S||(S={}));var I;(function(r){r.Direction="direction",r.Number="number",r.Slot="slot",r.MyItem="myItem",r.Box="box",r.Printer="printer",r.Shredder="shredder",r.Character="character",r.Hole="hole"})(I||(I={}));class ve extends C{constructor(e){super(e);this.conditions=[],this.conditions.push({type:w.Eq,leftType:S.Number,leftNumber:0,leftSlot:null,rightType:I.Number,rightNumber:0,rightSlot:null,logic:O.Or})}checkCondition(e){let l=!1;return this.conditions.forEach(t=>{var a,u,h,D;let s=!1;const i=t.type===w.Eq;if(t.rightType===I.Box)t.leftType===S.MyItem&&(s=!!e.item,i||(s=!s)),t.leftType===S.Slot&&e.slots[t.leftSlot]instanceof Q&&(s=!!e.slots[t.leftSlot].cellValue.item,i||(s=!s)),t.leftType===S.Direction&&(s=!!this.level.getMoveCell(e.cell.x,e.cell.y,t.leftDirection).item,i||(s=!s));else if(t.rightType===I.Printer||t.rightType===I.Shredder||t.rightType===I.Hole)t.leftType===S.Slot&&e.slots[t.leftSlot]instanceof Q&&(s=e.slots[t.leftSlot].cellValue.getType()===t.rightType,i||(s=!s)),t.leftType===S.Direction&&(s=this.level.getMoveCell(e.cell.x,e.cell.y,t.leftDirection).getType()===t.rightType,i||(s=!s));else{let d=0,v=0;switch(t.leftType===S.Number?d=t.leftNumber:t.leftType===S.Slot?d=e.slots[t.leftSlot].getNumberValue():t.leftType===S.MyItem?d=((a=e.item)==null?void 0:a.value)||0:t.leftType===S.Direction&&(d=((u=this.level.getMoveCell(e.cell.x,e.cell.y,t.leftDirection).item)==null?void 0:u.value)||0),t.rightType===I.Number?v=t.rightNumber:t.rightType===I.Slot?v=e.slots[t.rightSlot].getNumberValue():t.rightType===I.MyItem?v=((h=e.item)==null?void 0:h.value)||0:t.rightType===I.Direction&&(v=((D=this.level.getMoveCell(e.cell.x,e.cell.y,t.rightDirection).item)==null?void 0:D.value)||0),t.type){case w.Eq:s=d===v;break;case w.Ne:s=d!==v;break;case w.Gt:s=d>v;break;case w.Ge:s=d>=v;break;case w.Lt:s=d<v;break;case w.Le:s=d<=v;break}}t.logic===O.And?l=l&&s:t.logic===O.Or&&(l=l||s)}),l}remove(){const e=this.level.game.code.findIndex(l=>l===this.operatorEndIf);this.level.game.code.splice(e,1)}execute(e){return this.checkCondition(e)?e.currentLine+1:this.level.game.code.findIndex(l=>l===this.operatorEndIf)+1}createEndIf(){const e=new Je(this.level);return e.operatorIf=this,this.operatorEndIf=e,e}serialize(e){return{type:o.If,id:this.id,conditions:this.conditions,operatorEndIf:this.operatorEndIf.id,object:e?this:void 0}}deserialize(e){this.id=e.id,this.operatorEndIf=this.level.game.code.find(l=>l.id===e.id),this.conditions=e.conditions}}var $;(function(r){r.Printer="printer",r.Shredder="shredder",r.Hole="hole",r.Empty="empty"})($||($={}));class fe extends C{constructor(){super(...arguments);this.slot=0,this.nearType=$.Printer,this.numberValue=0,this.slotValue=0}execute(e){const l=this.level.findNear([e.cell.x,e.cell.y],s=>s.getType()===this.nearType);let t=l[l.length-1];return(this.nearType===$.Printer||this.nearType===$.Shredder)&&(t=this.level.getMoveCell(t.x,t.y,p.Up)),e.slots[this.slot]=new Q(e),e.slots[this.slot].setCell(t),e.currentLine+1}setSlot(e){this.slot=e}setNearType(e){this.nearType=e}serialize(e){return{type:o.Near,slot:this.slot,nearType:this.nearType,object:e?this:void 0}}deserialize(e){this.slot=e.slot,this.nearType=e.nearType}}class ye extends C{execute(e){return e.pickupItem(),e.currentLine+1}serialize(e){return{type:o.Pickup,object:e?this:void 0}}deserialize(e){}}class be extends C{execute(e){return e.say(this.hear,this.direction),e.currentLine+1}setSay(e){this.hear=e}setDirection(e){this.direction=e}serialize(e){return{type:o.Say,hear:this.hear,direction:this.direction,object:e?this:void 0}}deserialize(e){this.hear=e.hear,this.direction=e.direction}}class ge extends C{constructor(e){super(e);this.direction=p.Down}setDirection(e){this.direction=e}execute(e){return e.take(this.direction),e.currentLine+1}serialize(e){return{type:o.Take,direction:this.direction,object:e?this:void 0}}deserialize(e){this.direction=e.direction}}var R;(function(r){r.Number="number",r.Slot="slot",r.MyItem="myItem"})(R||(R={}));class je extends C{constructor(){super(...arguments);this.slot=0,this.variableType=R.Number,this.numberValue=0,this.slotValue=0}execute(e){return this.variableType===R.Number&&(e.slots[this.slotValue]=new q(e),e.slots[this.slotValue].setNumber(this.numberValue)),e.currentLine+1}setSlot(e){this.slot=e}setNumberValue(e){this.variableType=R.Number,this.numberValue=e}setSlotValue(e){this.variableType=R.Slot,this.slotValue=e}setMyItemValue(){this.variableType=R.MyItem}serialize(e){return{type:o.Variable,slot:this.slot,variableType:this.variableType,numberValue:this.numberValue,slotValue:this.slotValue,object:e?this:void 0}}deserialize(e){this.slot=e.slot,this.variableType=e.variableType,this.numberValue=e.numberValue,this.slotValue=e.slotValue}}class Ce extends C{constructor(){super(...arguments);this.value=0}execute(e){return e.write(this.value),e.currentLine+1}setLine(e){this.value=e}serialize(e){return{type:o.Write,value:this.value,object:e?this:void 0}}deserialize(e){this.value=e.value}}var V;(function(r){r.Run="Run",r.Stop="Stop"})(V||(V={}));class X{constructor(){this.code=[],this.state=V.Stop,this.speed=1e3}getLevel(){return this.level}setLevel(e){this.level=e}addOperator(e,l){let t;e===o.Pickup&&(t=new ye(this.level)),e===o.Drop&&(t=new ce(this.level)),e===o.End&&(t=new he(this.level)),e===o.Goto&&(t=new pe(this.level)),e===o.Hear&&(t=new me(this.level)),e===o.If&&(t=new ve(this.level),this.code.splice(l,0,t.createEndIf())),e===o.Say&&(t=new be(this.level)),e===o.Step&&(t=new le(this.level)),e===o.Take&&(t=new ge(this.level)),e===o.Variable&&(t=new je(this.level)),e===o.Write&&(t=new Ce(this.level)),e===o.Foreach&&(t=new de(this.level),this.code.splice(l,0,t.createEndForeach())),e===o.Give&&(t=new ue(this.level)),e===o.Near&&(t=new fe(this.level)),e===o.Calc&&(t=new qe(this.level)),t&&this.code.splice(l,0,t)}removeOperator(e){const l=this.code[e];this.code.splice(e,1),l.remove()}start(){this.state=V.Run,this.interval=window.setInterval(()=>{this.state===V.Run&&this.update()},this.speed)}stop(){clearInterval(this.interval),this.state=V.Stop}update(){!this.level.getCharacters().filter(e=>!e.isTerminated).length||(this.level.getCharacters().forEach(e=>{e.prepare()}),this.level.getCharacters().forEach(e=>{e.update()}),this.level.moveCharacters(),this.level.winCallback(this.level),this.level.getCharacters().length<2&&console.log("Wrong character"),console.log(this.level.cells),this.render())}deserialize(e){this.level||(this.level=new z(this)),this.level.deserialize(e.level),this.code=e.code.map(l=>{if(l.type===o.Drop){const t=new ce(this.level);return t.deserialize(l),t}if(l.type===o.End){const t=new he(this.level);return t.deserialize(l),t}if(l.type===o.Foreach){const t=new de(this.level);return t.deserialize(l),t}if(l.type===o.Give){const t=new ue(this.level);return t.deserialize(l),t}if(l.type===o.Goto){const t=new pe(this.level);return t.deserialize(l),t}if(l.type===o.Hear){const t=new me(this.level);return t.deserialize(l),t}if(l.type===o.If){const t=new ve(this.level);return t.deserialize(l),t}if(l.type===o.Near){const t=new fe(this.level);return t.deserialize(l),t}if(l.type===o.Pickup){const t=new ye(this.level);return t.deserialize(l),t}if(l.type===o.Say){const t=new be(this.level);return t.deserialize(l),t}if(l.type===o.Step){const t=new le(this.level);return t.deserialize(l),t}if(l.type===o.Take){const t=new ge(this.level);return t.deserialize(l),t}if(l.type===o.Variable){const t=new je(this.level);return t.deserialize(l),t}if(l.type===o.Write){const t=new Ce(this.level);return t.deserialize(l),t}return null})}serialize(e=!1){return{level:this.level.serialize(e),code:this.code.map(l=>l.serialize(e)),state:this.state,speed:this.speed,object:e?this:void 0}}moveOperator(e,l){if(!this.code[e]||!this.code[l])return;const t=this.code[e];this.code.splice(e,1),this.code.splice(l,0,t)}render(){console.log("render"),this.renderCallback(this.serialize(!0))}}const N=80;function xe(r){const e=r.game.object.level.cells,l=Object.keys(e).map(s=>{const i=se(s),a=e[s];let u;return a instanceof A&&(u=null,a.getItem()&&(u=c(G,{children:[n(K,{fontSize:"small"})," ",a.item.isRandom&&r.game.state!==V.Run?"?":a.item.value]}))),a instanceof ae&&(u=n("div",{style:{width:"100%",height:"100%",backgroundColor:"black"}})),a instanceof oe&&(u="wall"),a instanceof B&&(u="printer"),a instanceof J&&(u="shredder"),n("div",{onClick:()=>r.onClick(s),style:{position:"absolute",left:i[0]*N,top:i[1]*N,width:N,height:N,borderStyle:"solid",borderColor:"black",borderWidth:1,display:"flex",alignItems:"center",justifyContent:"center"},children:u},s)}),t=r.game.object.level.getCharacters().sort((s,i)=>s.name>i.name?1:-1).map(s=>{const i=[s.cell.x,s.cell.y];return c("div",{style:{position:"absolute",opacity:s.isDead?0:1,transform:`translate(${i[0]*N}px, ${i[1]*N+10}px)`,transition:`all ${r.game.speed}ms ease-in`},children:[n(M,{fontSize:"small",style:{color:s.color}}),s.item?c(G,{children:["(",n(K,{fontSize:"small"})," ",s.item.value,")"]}):null]},s.name)});return c("div",{style:{position:"relative",width:r.game.level.width*N+N/2,height:r.game.level.height*N+N/2},children:[l,t]})}function Qe(r){return n(G,{children:Object.values(o).map(e=>n("div",{children:n(k,{onClick:()=>{r.game.object.addOperator(e,0),r.game.object.render()},children:`Add ${e}`})},e))})}const Xe=(r,e,l)=>c("span",{children:["Step:"," ",n(f,{IconComponent:null,value:r.object.type,onChange:t=>{t.target.value===x.Direction&&(r.object.setDirection([p.Down]),l.object.render()),t.target.value===x.Slot&&(r.object.setSlot(0),l.object.render())},variant:"standard",children:Object.values(x).map(t=>n(y,{value:t,children:t},t))}),r.object.type===x.Direction&&n(f,{IconComponent:null,value:r.object.directions,variant:"standard",multiple:!0,onChange:t=>{r.object.setDirection(t.target.value),l.object.render()},children:Object.values(p).map(t=>c(y,{value:t,children:[L(t),t]},t))}),r.object.type===x.Slot&&n(g,{type:"number",value:r.slot,variant:"standard",onChange:t=>{r.object.setSlot(parseInt(t.target.value)||0),l.object.render()}})]}),Ye=(r,e,l)=>c("span",{children:["Give:"," ",n(M,{fontSize:"small"}),n(Z,{fontSize:"small"}),n(ee,{fontSize:"small"})," ",n(f,{IconComponent:null,value:r.direction,variant:"standard",onChange:t=>{r.object.setDirection(t.target.value),l.object.render()},children:Object.values(p).map(t=>c(y,{value:t,children:[L(t),t]},t))})]}),Ze=(r,e,l)=>c("span",{children:["Take"," ",n(M,{fontSize:"small"}),n(Y,{fontSize:"small"}),n(ee,{fontSize:"small"})," ",n(f,{IconComponent:null,value:r.direction,variant:"standard",onChange:t=>{r.object.setDirection(t.target.value),l.object.render()},children:Object.values(p).map(t=>c(y,{value:t,children:[L(t),t]},t))})]}),Ke=(r,e,l)=>c("span",{children:["Goto:"," ",n(f,{IconComponent:null,value:r.line,variant:"standard",onChange:t=>{r.object.setLine(parseInt(t.target.value.toString())),l.object.render()},children:Object.keys(l.code).map(t=>n(y,{value:t,children:t},t))})]}),et=(r,e,l)=>c("span",{children:["If:"," ",r.conditions.map((t,s)=>c("span",{children:[!!s&&n(f,{IconComponent:null,value:t.logic,variant:"standard",onChange:i=>{r.object.conditions[s].logic=i.target.value,l.object.render()},children:Object.values(O).map(i=>n(y,{value:i,children:i},i))}),n(f,{IconComponent:null,value:t.leftType,onChange:i=>{r.object.conditions[s].leftType=i.target.value,l.object.render()},variant:"standard",children:Object.values(S).map(i=>n(y,{value:i,children:i},i))}),t.leftType==="direction"&&n(f,{IconComponent:null,value:t.leftDirection,variant:"standard",onChange:i=>{r.object.conditions[s].leftDirection=i.target.value,l.object.render()},children:Object.values(m).map(i=>c(y,{value:i,children:[L(i),i]},i))}),t.leftType==="slot"&&n(g,{type:"number",value:t.leftSlot,variant:"standard",onChange:i=>{r.object.conditions[s].leftSlot=parseInt(i.target.value)||0,l.object.render()}}),n(f,{IconComponent:null,value:t.type,variant:"standard",onChange:i=>{r.object.conditions[s].type=i.target.value,l.object.render()},children:Object.values(w).map(i=>n(y,{value:i,children:i},i))}),n(f,{IconComponent:null,value:t.rightType,onChange:i=>{r.object.conditions[s].rightType=i.target.value,l.object.render()},variant:"standard",children:Object.values(S).map(i=>n(y,{value:i,children:i},i))}),t.rightType==="number"&&n(g,{type:"number",value:t.rightNumber,variant:"standard",onChange:i=>{r.object.conditions[s].rightNumber=parseInt(i.target.value)||0,l.object.render()}}),t.rightType==="direction"&&n(f,{IconComponent:null,value:t.rightDirection,variant:"standard",onChange:i=>{r.object.conditions[s].rightDirection=i.target.value,l.object.render()},children:Object.values(m).map(i=>c(y,{value:i,children:[L(i),i]},i))}),t.rightType==="slot"&&n(g,{type:"number",value:t.rightSlot,variant:"standard",onChange:i=>{r.object.conditions[s].rightSlot=parseInt(i.target.value)||0}}),n(H,{size:"small",onMouseDown:()=>{const i=r.object.conditions;i.splice(s,1),r.object.conditions=i,l.object.render()},children:n(ze,{})}),s===r.conditions.length-1&&n(H,{size:"small",onMouseDown:()=>{r.object.conditions.push({logic:O.And,leftType:S.Slot,leftSlot:0,type:w.Eq,rightType:I.Number,rightSlot:0}),l.object.render()},children:n(Te,{})})]},s))]}),tt=()=>"Pickup",rt=()=>"Drop",lt=(r,e,l)=>c("span",{children:["Near:"," ","slot",n(g,{type:"number",value:r.slot,variant:"standard",onChange:t=>{r.object.setSlot(parseInt(t.target.value)||0),l.object.render()}}),"=",n(f,{IconComponent:null,value:r.nearType,onChange:t=>{r.object.setNearType(t.target.value),l.object.render()},variant:"standard",children:Object.values($).map(t=>n(y,{value:t,children:t},t))})]}),st=(r,e,l)=>c("span",{children:["Variable"," ","slot",n(g,{type:"number",value:r.slot,variant:"standard",onChange:t=>{r.object.setSlot(parseInt(t.target.value)||0),l.object.render()}}),"=",n(f,{IconComponent:null,value:r.variableType,onChange:t=>{t.target.value==="number"&&r.object.setNumberValue(0),t.target.value==="myitem"&&r.object.setMyItemValue(),t.target.value==="slot"&&r.object.setSlotValue(0)},variant:"standard",children:Object.values(R).map(t=>n(y,{value:t,children:t},t))}),r.variableType==="number"&&n(g,{type:"number",value:r.numberValue,variant:"standard",onChange:t=>{r.object.setNumberValue(parseInt(t.target.value)||0),l.object.render()}}),r.variableType==="slot"&&n(g,{type:"number",value:r.slotValue,variant:"standard",onChange:t=>{r.object.setSlotValue(parseInt(t.target.value)||0),l.object.render()}})]}),it=(r,e,l)=>c("span",{children:["Calc"," ","slot",n(g,{type:"number",value:r.slotResult,variant:"standard",onChange:t=>{r.object.slotResult=parseInt(t.target.value)||0,l.object.render()}}),"=",n(f,{IconComponent:null,value:r.operand1type,onChange:t=>{t.target.value==="number"&&r.object.setOperand1Number(0),t.target.value==="direction"&&r.object.setOperand1Direction(m.Up),t.target.value==="slot"&&r.object.setOperand1Slot(0),l.object.render()},variant:"standard",children:Object.values(b).map(t=>n(y,{value:t,children:t},t))}),r.operand1type===b.Number&&n(g,{type:"number",value:r.operand1NumberValue,variant:"standard",onChange:t=>{r.object.setOperand1Number(parseInt(t.target.value)||0),l.object.render()}}),r.operand1type===b.Direction&&n(f,{IconComponent:null,value:r.operand1DirectionValue,variant:"standard",onChange:t=>{r.object.setOperand1Direction(t.target.value),l.object.render()},children:Object.values(m).map(t=>c(y,{value:t,children:[L(t),t]},t))}),r.operand1type===b.Slot&&n(g,{type:"number",value:r.operand1SlotValue,variant:"standard",onChange:t=>{r.object.setOperand1Slot(parseInt(t.target.value)||0),l.object.render()}}),n(f,{IconComponent:null,value:r.operator,variant:"standard",onChange:t=>{r.operator=t.target.value},children:Object.values(E).map(t=>n(y,{value:t,children:t},t))}),n(f,{IconComponent:null,value:r.operand2type,onChange:t=>{t.target.value==="number"&&r.object.setOperand2Number(0),t.target.value==="direction"&&r.object.setOperand2Direction(m.Up),t.target.value==="slot"&&r.object.setOperand2Slot(0),l.object.render()},variant:"standard",children:Object.values(b).map(t=>n(y,{value:t,children:t},t))}),r.operand2type===b.Number&&n(g,{type:"number",value:r.operand2NumberValue,variant:"standard",onChange:t=>{r.object.setOperand2Number(parseInt(t.target.value)||0),l.object.render()}}),r.operand2type===b.Direction&&n(f,{IconComponent:null,value:r.operand2DirectionValue,variant:"standard",onChange:t=>{r.object.setOperand2Direction(t.target.value),l.object.render()},children:Object.values(m).map(t=>c(y,{value:t,children:[L(t),t]},t))}),r.operand2type===b.Slot&&n(g,{type:"number",value:r.operand2SlotValue,variant:"standard",onChange:t=>{r.object.setOperand2Slot(parseInt(t.target.value)||0),l.object.render()}})]}),nt=(r,e,l)=>c("span",{children:["Say:"," ",n(g,{value:r.hear,variant:"standard",onChange:t=>{r.object.setSay(t.target.value),l.object.render()}}),n(f,{IconComponent:null,value:r.direction,variant:"standard",onChange:t=>{r.object.setDirection(t.target.value),l.object.render()},children:Object.values(p).map(t=>c(y,{value:t,children:[L(t),t]},t))})]}),at=(r,e,l)=>c("span",{children:["Hear:"," ",n(g,{value:r.hear,variant:"standard",onChange:t=>{r.object.hear=t.target.value,l.object.render()}})]}),ot=(r,e,l)=>c("span",{children:["Foreach:"," ",n(f,{IconComponent:null,value:r.directions,variant:"standard",multiple:!0,onChange:t=>{r.object.setDirections(t.target.value),l.object.render()},children:Object.values(p).map(t=>c(y,{value:t,children:[L(t),t]},t))}),n(g,{type:"number",value:r.slotNumber,variant:"standard",onChange:t=>{r.object.slotNumber=parseInt(t.target.value)||0,l.object.render()}})]}),ct=()=>"End",ht=(r,e,l)=>c("span",{children:["Write"," ",n(g,{type:"number",value:r.value,variant:"standard",onChange:t=>{r.object.value=parseInt(t.target.value)||0,l.object.render()}})]});function dt(r,e,l,t){let s=null;return r.type==="step"&&(s=Xe(r,e,l)),r.type==="give"&&(s=Ye(r,e,l)),r.type==="take"&&(s=Ze(r,e,l)),r.type==="goto"&&(s=Ke(r,e,l)),r.type==="if"&&(s=et(r,e,l)),r.type==="endif"&&(s="Endif"),r.type==="pickup"&&(s=tt()),r.type==="drop"&&(s=rt()),r.type==="near"&&(s=lt(r,e,l)),r.type==="variable"&&(s=st(r,e,l)),r.type==="calc"&&(s=it(r,e,l)),r.type==="say"&&(s=nt(r,e,l)),r.type==="hear"&&(s=at(r,e,l)),r.type==="foreach"&&(s=ot(r,e,l)),r.type==="endforeach"&&(s="Endforeach"),r.type==="end"&&(s=ct()),r.type==="write"&&(s=ht(r,e,l)),r.type==="endif"&&(t-=20),r.type==="endforeach"&&(t-=20),s=c("span",{children:[e,": ",n("span",{style:{paddingLeft:t},children:s}),n(H,{size:"small",onMouseDown:()=>{l.object.removeOperator(e),l.object.render()},children:n(Ee,{fontSize:"small"})})]},e),r.type==="if"&&(t+=20),r.type==="foreach"&&(t+=20),{result:s,intend:t}}const ut=Re(({children:r})=>n("div",{children:r})),pt=Oe(({children:r})=>n("div",{children:r}));function mt(r){const[e,l]=T.exports.useState();T.exports.useEffect(()=>{const i=new X;i.deserialize(r.level),i.renderCallback=l,i.render()},[r.level]);let t=0;const s=T.exports.useMemo(()=>e?e.code.map((i,a)=>{const u=dt(i,a,e,t);return t=u.intend,u.result}):[],[e==null?void 0:e.code]);return e?c(P,{container:!0,children:[c(P,{item:!0,md:6,children:[n("h2",{children:e.level.task}),n("h4",{children:e.state===V.Run&&e.level.winCallback(e.level.object)?"Win":null}),n(xe,{game:e})]}),n(P,{item:!0,md:1,children:n(Qe,{game:e})}),n(P,{item:!0,md:5,children:c("div",{style:{paddingLeft:20},children:[n(pt,{onSortEnd:({oldIndex:i,newIndex:a},u)=>{u.ctrlKey||(e.object.moveOperator(i,a),e.object.render())},children:e.code.map((i,a)=>c(ut,{index:a,children:[e.object.level.getCharacters().filter(h=>h.currentLine===a).map(h=>n("span",{children:n(M,{fontSize:"small",style:{color:h.color}})},h.name)),s[a]]},a))}),c("div",{style:{paddingTop:20},children:["Speed:"," ",n(g,{variant:"standard",type:"number",value:1e3/e.speed,onChange:i=>{e.object.speed=1e3/(parseInt(i.target.value)||1),e.object.render()}})]}),c("div",{style:{display:"flex",gap:4},children:[n("div",{children:n(k,{variant:"contained",onClick:()=>{e.object.level.deserialize(r.level.level),e.object.render(),e.object.state===V.Run?e.object.stop():e.object.start()},disabled:t!==0,children:e.object.state===V.Run?"Stop":"Run"})}),n("div",{children:n(k,{variant:"contained",onClick:()=>_(JSON.stringify(e.object.serialize(),null,2)),children:"Copy"})}),n("div",{children:n(k,{variant:"contained",onClick:()=>{},children:"Clear"})})]}),e.object.level.getCharacters().map(i=>{var a;return c("div",{children:[i.name," ",n("span",{style:{color:i.color},children:n(M,{fontSize:"small"})})," ",(a=i.slots)==null?void 0:a.map((u,h)=>c("span",{children:[u.getNumberValue()," "]},h))]},i.name)}),n("pre",{children:JSON.stringify(Object.values(e.object.level.cells).filter(i=>i.character).map(i=>{var a;return{name:(a=i.character)==null?void 0:a.name,line:i.character.currentLine,x:i.x,y:i.y}}),null,2)})]})})]}):null}const vt={level:{task:"Remove two boxes",width:5,height:7,cells:z.parseCells(`box|1 box|1 wall box|1 hole
empty empty wall box|2 empty
empty empty wall box|3 empty
empty empty wall box|4 printer
empty empty empty box|5 empty
hole hole
hole hole`,[{coordinates:[0,0],name:"first",color:"red"},{coordinates:[1,0],name:"second",color:"green"}]),winCallback:r=>Object.values(r.cells).filter(e=>e.item).length+r.getCharacters().filter(e=>!e.isDead&&e.item).length===5},code:[]},ft={level:{task:"Move boxes",width:5,height:5,cells:z.parseCells(`box|1 box|1 empty box|1 empty
        empty empty wall box|2 empty
        empty empty wall box|3 empty
        empty empty empty box|4 empty
        empty empty empty box|5 empty`,[{coordinates:[0,0],name:"first",color:"red"},{coordinates:[1,0],name:"second",color:"green"}]),winCallback:r=>Object.values(r.cells).filter(e=>e.item).length+r.getCharacters().filter(e=>!e.isDead&&e.item).length===5},code:[{type:o.Step,stepType:x.Direction,directions:[p.Left,p.Right,p.Up,p.Down]},{type:o.Step,stepType:x.Direction,directions:[p.Left,p.Right,p.Up,p.Down]},{type:o.Pickup},{type:o.Step,stepType:x.Direction,directions:[p.Left,p.Right,p.Up,p.Down]},{type:o.Step,stepType:x.Direction,directions:[p.Left,p.Right,p.Up,p.Down]},{type:o.Drop},{type:o.Goto,line:0}]},yt={level:{task:"Remove only box with 2",width:5,height:7,cells:z.parseCells(`empty empty empty empty empty
box|2|tag2 box|1|tag1 wall empty empty
empty empty wall empty empty
empty empty empty empty empty
empty empty empty empty empty
hole hole
hole hole`,[{coordinates:[0,0],name:"first",color:"red"},{coordinates:[1,0],name:"second",color:"green"}]),winCallback:r=>(Object.values(r.cells).find(e=>{var l;return((l=e.item)==null?void 0:l.tag)==="tag1"})||r.getCharacters().find(e=>{var l;return((l=e.item)==null?void 0:l.tag)==="tag1"}))&&!(Object.values(r.cells).find(e=>{var l;return((l=e.item)==null?void 0:l.tag)==="tag2"})||r.getCharacters().find(e=>{var l;return!e.isTerminated&&((l=e.item)==null?void 0:l.tag)==="tag2"}))},code:[]},bt={level:{task:"Diagonal boxes",width:5,height:7,cells:z.parseCells(`empty empty empty empty empty
box|1 box|1 box|1 box|1 box|1
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty`,[{coordinates:[1,1],name:"first",color:"red"},{coordinates:[2,1],name:"second",color:"green"},{coordinates:[3,1],name:"3",color:"yellow"},{coordinates:[4,1],name:"4",color:"blue"}]),winCallback:r=>[0,1,2,3,4].every(e=>r.cells[`${e}x${e+1}`].item)},code:[]},gt={level:{task:"Sort numbers",width:5,height:5,cells:z.parseCells(`empty empty empty empty empty
box|random box|0 box|random box|random box|random
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty`,[{coordinates:[0,1],name:"1",color:"purple"},{coordinates:[1,1],name:"2",color:"red"},{coordinates:[2,1],name:"3",color:"green"},{coordinates:[3,1],name:"4",color:"yellow"},{coordinates:[4,1],name:"5",color:"blue"}]),winCallback:r=>[0,1,2,3,4].every(e=>{var l,t,s,i;return e===0||((t=(l=r.cells[`${e}x1`].character)==null?void 0:l.item)==null?void 0:t.value)>=((i=(s=r.cells[`${e-1}x1`].character)==null?void 0:s.item)==null?void 0:i.value)})},code:[]},jt={level:{task:"Print and shred 10 boxes",width:5,height:5,cells:z.parseCells(`empty empty empty empty empty
empty empty empty empty empty
empty printer shredder empty empty
empty empty empty empty empty
empty empty empty empty empty`,[{coordinates:[1,1],name:"first",color:"red"},{coordinates:[2,1],name:"second",color:"green"}]),winCallback:r=>r.cells["2x2"].shredded>=10},code:[]},Ct={level:{task:"Print and shred 10 boxes (no move)",width:7,height:5,cells:z.parseCells(`hole hole hole hole hole hole hole
hole empty empty empty empty empty hole
hole printer hole hole hole shredder hole
hole hole hole hole hole hole hole
hole hole hole hole hole hole hole`,[{coordinates:[1,1],name:"1",color:"purple"},{coordinates:[2,1],name:"2",color:"red"},{coordinates:[3,1],name:"3",color:"green"},{coordinates:[4,1],name:"4",color:"yellow"},{coordinates:[5,1],name:"5",color:"blue"}]),winCallback:r=>r.cells["5x2"].shredded>=10},code:[]},U=[vt,ft,yt,bt,gt,jt,Ct];function xt(r){var D;const[e,l]=T.exports.useState(()=>{const d=new X;return d.deserialize(U[0]),d.renderCallback=v=>l(v),d.serialize(!0)}),[t,s]=T.exports.useState(!1),i=e.object.level.cells[t],[a,u]=T.exports.useState(0),h=JSON.stringify(e.object.serialize(),null,2);return c("div",{children:[c("div",{children:[n(f,{variant:"standard",value:a,onChange:d=>u(parseInt(d.target.value)),children:U.map((d,v)=>n(y,{value:v,children:d.level.task},v))}),n(k,{onClick:()=>{const d=new X;d.deserialize(U[a]),d.renderCallback=v=>l(v),d.render()},children:"Import"})]}),c("div",{children:[n(g,{label:"width",value:e.level.width,variant:"standard",onChange:d=>{e.object.level.changeSize(parseInt(d.target.value),e.level.height),e.object.render()}}),n(g,{label:"height",value:e.level.height,variant:"standard",onChange:d=>{e.object.level.changeSize(e.level.width,parseInt(d.target.value)),e.object.render()}}),n(k,{onClick:()=>{e.object.level.crop(e.object.level.width,e.object.level.height),e.object.render()},children:"Crop"})]}),n(xe,{game:e,onClick:d=>s(d)}),c("div",{children:[c("div",{children:[n(k,{onClick:()=>_(JSON.stringify(e.object.level.serialize(!1),null,2)),children:"Copy cells"}),n(k,{onClick:()=>_(JSON.stringify(e.object.level.getCharacters(),null,2)),children:"Copy characters"}),n(k,{onClick:()=>_(h),children:"Copy level"})]}),c("pre",{children:[n("div",{children:h}),n("div",{children:JSON.stringify(e.object.level.serialize(!1),null,2)}),n("div",{children:JSON.stringify(e.object.serialize(),(d,v)=>typeof v=="function"?`${v}`:v,2)})]})]}),c($e,{open:t!==!1,onClose:()=>s(!1),children:[n(Me,{children:t}),c(Fe,{children:[n("div",{children:n(f,{value:i==null?void 0:i.getType(),onChange:d=>{const v=se(t);e.object.level.addCell(v[0],v[1],new A(e.object.level,v[0],v[1])),e.object.render()},children:Object.values(j).map(d=>n(y,{value:d,children:d},d))})}),(i==null?void 0:i.getType())==="empty"?c("div",{children:["Item:"," ",n(te,{checked:!!(i==null?void 0:i.item),onChange:d=>{d.target.checked?i.setItem(new W(0)):i.setItem(null),e.object.render()}})]}):null,(i==null?void 0:i.item)?n("div",{children:n(g,{label:"Item value",value:(D=i==null?void 0:i.item)==null?void 0:D.value,variant:"standard",onChange:d=>{i.item.value=parseInt(d.target.value)||0,e.object.render()}})}):null,(i==null?void 0:i.getType())==="empty"?c("div",{children:["Character:"," ",n(te,{checked:!!i.character,onChange:d=>{d.target.checked?(i.setCharacter(new ne(i,`${e.object.level.getCharacters().length+1}`)),i.character.color="green"):i.character=null,e.object.render()}})]}):null]})]})]})}const St=Ue({components:{MuiTextField:{styleOverrides:{root:{width:"50px","& input":{textAlign:"center"}}}},MuiSelect:{styleOverrides:{select:{paddingLeft:"24px"}}}}});function wt(){const[r,e]=T.exports.useState(0),[l,t]=T.exports.useState(!1);return n(Ge,{theme:St,children:c("div",{className:"App",children:[n("h1",{children:"Open7BH"}),c(Pe,{value:l?1:0,onChange:(s,i)=>t(i===1),children:[n(re,{label:"Game"}),n(re,{label:"Editor"})]}),l?n(xt,{}):c(G,{children:[n("div",{children:n(f,{variant:"standard",value:r,onChange:s=>e(parseInt(s.target.value)),children:U.map((s,i)=>n(y,{value:i,children:s.level.task},i))})}),n(mt,{level:U[r],levelNumber:r})]})]})})}const It="modulepreload",Se={},Dt="./",Vt=function(e,l){return!l||l.length===0?e():Promise.all(l.map(t=>{if(t=`${Dt}${t}`,t in Se)return;Se[t]=!0;const s=t.endsWith(".css"),i=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${i}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":It,s||(a.as="script",a.crossOrigin=""),a.href=t,document.head.appendChild(a),s)return new Promise((u,h)=>{a.addEventListener("load",u),a.addEventListener("error",h)})})).then(()=>e())},Nt=r=>{r&&r instanceof Function&&Vt(()=>import("./web-vitals.67dce932.js"),[]).then(({getCLS:e,getFID:l,getFCP:t,getLCP:s,getTTFB:i})=>{e(r),l(r),t(r),s(r),i(r)})},kt=_e.createRoot(document.getElementById("root"));kt.render(n(Ae.StrictMode,{children:n(wt,{})}));Nt();
