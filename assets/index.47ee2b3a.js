import{j as i,d as xe,a as be,b as je,c as Ee,e as _e,f as ze,g as De,h as Me,i as Te,k as c,F as K,l as Ce,m as X,B as A,v as E,S as w,M as x,T as C,n as Ie,I as le,o as Ae,p as Je,q as Fe,s as Be,r as Ge,t as R,G as N,u as Pe,w as ee,D as We,x as qe,y as He,C as Se,z as Ve,A as Qe,E as Ue,H as ke,J as Xe,R as Ye}from"./vendor.c60dcdaf.js";const Ze=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?e.credentials="include":t.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function n(t){if(t.ep)return;t.ep=!0;const e=o(t);fetch(t.href,e)}};Ze();const G=a=>a.split("x").map(l=>parseInt(l)),J=a=>{const l={};return a.split(/[\r\n]+/).forEach((o,n)=>{o.split(/ +/).forEach((t,e)=>{const s=t.split("|"),p={type:s[0]};s[0]==="box"&&(p.type="empty",p.item={type:"box",value:parseInt(s[1]),tag:s[2],isRandom:s[1]==="random"}),l[`${e}x${n}`]=p})}),l},ne=a=>{var t;let l="",o=0,n=0;Object.keys(a).forEach(e=>{const s=G(e);s[0]+1>o&&(o=s[0]+1),s[1]+1>n&&(n=s[1]+1)});for(let e=0;e<n;e++){for(let s=0;s<o;s++){const p=a[`${s}x${e}`];p?p.type!=="empty"?l+=`${p.type} `:((t=p.item)==null?void 0:t.type)==="box"?l+=`box|${p.item.isRandom?"random":p.item.value}|${p.item.tag||""} `:l+="empty ":l+="nothing "}l=`${l.trim()}
`}return l.trim()},Ke=a=>a[Math.floor(Math.random()*a.length)],$e=(a,l)=>(a=Math.ceil(a),l=Math.floor(l),Math.floor(Math.random()*(l-a+1))+a),z=(a,l)=>{const o=[...a];return l==="left"&&(o[0]-=1),l==="right"&&(o[0]+=1),l==="top"&&(o[1]-=1),l==="bottom"&&(o[1]+=1),l==="top-left"&&(o[0]-=1,o[1]-=1),l==="top-right"&&(o[0]+=1,o[1]-=1),l==="bottom-left"&&(o[0]-=1,o[1]+=1),l==="bottom-right"&&(o[0]+=1,o[1]+=1),o},M=a=>{const o={left:xe,right:be,top:je,bottom:Ee,"top-left":_e,"top-right":ze,"bottom-left":De,"bottom-right":Me,here:Te}[a];return o?i(o,{fontSize:"small"}):null},u=a=>JSON.parse(JSON.stringify(a)),Oe=(a,l)=>a.find(o=>o.coordinates===l),T=80;function Re(a){const l=Object.keys(a.cells).map(n=>{var p;const t=G(n),e=a.cells[n];let s;return(e.type==="empty"||e.type==="nothing")&&(s=null),e.type==="hole"&&(s=i("div",{style:{width:"100%",height:"100%",backgroundColor:"black"}})),e.type==="wall"&&(s="wall"),e.type==="printer"&&(s="printer"),e.type==="shredder"&&(s="shredder"),((p=e.item)==null?void 0:p.type)==="box"&&(s=c(K,{children:[i(Ce,{fontSize:"small"})," ",e.item.isRandom&&!a.run?"?":e.item.value]})),i("div",{onClick:()=>a.onClick(n),style:{position:"absolute",left:t[0]*T,top:t[1]*T,width:T,height:T,borderStyle:e.type==="nothing"?"dotted":"solid",borderColor:"black",borderWidth:1,display:"flex",alignItems:"center",justifyContent:"center"},children:s},n)}),o=a.characters.map(n=>{var e;const t=G(n.coordinates);return c("div",{style:{position:"absolute",opacity:n.terminated?0:1,transform:`translate(${t[0]*T}px, ${t[1]*T+10}px)`,transition:`all ${a.speed}ms ease-in`},children:[i(X,{fontSize:"small",style:{color:n.color}}),((e=n.item)==null?void 0:e.type)==="box"?c(K,{children:["(",i(Ce,{fontSize:"small"})," ",n.item.value,")"]}):null]},n.name)});return c("div",{style:{position:"relative",width:a.width*T+T/2,height:a.height*T+T/2},children:[l,o]})}const Ne=[{type:"step",add:a=>{a.push({type:"step",destination:{type:"direction",directions:["left"]},id:E()})}},{type:"give",add:a=>{a.push({type:"give",direction:{type:"direction",value:"left"},id:E()})}},{type:"take",add:a=>{a.push({type:"take",direction:{type:"direction",value:"left"},id:E()})}},{type:"goto",add:a=>{a.push({type:"goto",step:0,id:E()})}},{type:"pickup",add:a=>{a.push({type:"pickup",id:E()})}},{type:"drop",add:a=>{a.push({type:"drop",id:E()})}},{type:"if",add:a=>{const l=E();a.push({type:"if",conditions:[{value1:{type:"direction",value:"here"},operation:"==",value2:{type:"number",value:0},logic:"OR"}],id:l},{type:"endif",ifId:l})}},{type:"near",add:a=>{a.push({type:"near",find:"wall",slot:1,id:E()})}},{type:"variable",add:a=>{a.push({type:"variable",slot:1,value:{type:"number",value:0},id:E()})}},{type:"calc",add:a=>{a.push({type:"calc",slot:1,value1:{type:"number",value:0},operation:"+",value2:{type:"number",value:0},id:E()})}},{type:"say",add:a=>{a.push({type:"say",text:"hi",target:{type:"direction",value:"left"},id:E()})}},{type:"hear",add:a=>{a.push({type:"hear",text:"hi",id:E()})}},{type:"foreach",add:a=>{const l=E();a.push({type:"foreach",directions:["left"],slot:1,id:l},{type:"endforeach",foreachId:l})}},{type:"end",add:a=>{a.push({type:"end"})}},{type:"write",add:a=>{a.push({type:"write",value:{type:"number",value:0}})}}];function et(a){return i(K,{children:Ne.map(l=>i("div",{children:i(A,{onClick:()=>{const o=[...a.code];l.add(o),a.setCode(o)},children:`Add ${l.type}`})},l.type))})}const tt=(a,l,o,n)=>c("span",{children:["Step:"," ",i(w,{IconComponent:null,value:a.destination.type,onChange:t=>{const e=u(o);t.target.value==="direction"&&(e[l].destination={type:"direction",directions:["left"]}),t.target.value==="slot"&&(e[l].destination={type:"slot",slot:1}),n(e)},variant:"standard",children:["direction","slot"].map(t=>i(x,{value:t,children:t},t))}),a.destination.type==="direction"&&i(w,{IconComponent:null,value:a.destination.directions,variant:"standard",multiple:!0,onChange:t=>{const e=u(o);e[l].destination.directions=t.target.value,n(e)},children:["left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),a.destination.type==="slot"&&i(C,{type:"number",value:a.destination.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].destination.slot=parseInt(t.target.value)||0,n(e)}})]}),at=(a,l,o,n)=>c("span",{children:["Give:"," ",i(X,{fontSize:"small"}),i(be,{fontSize:"small"}),i(Ie,{fontSize:"small"})," ",i(w,{IconComponent:null,value:a.direction.type,onChange:t=>{const e=u(o);t.target.value==="direction"&&(e[l].direction={type:"direction",value:"left"}),t.target.value==="slot"&&(e[l].direction={type:"slot",slot:1}),n(e)},variant:"standard",children:["direction","slot"].map(t=>i(x,{value:t,children:t},t))}),i(w,{IconComponent:null,value:a.direction.value,variant:"standard",onChange:t=>{const e=u(o);e[l].direction.value=t.target.value,n(e)},children:["left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),a.direction.type==="slot"&&i(C,{type:"number",value:a.direction.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].direction.slot=parseInt(t.target.value)||0,n(e)}})]}),lt=(a,l,o,n)=>c("span",{children:["Take"," ",i(X,{fontSize:"small"}),i(xe,{fontSize:"small"}),i(Ie,{fontSize:"small"})," ",i(w,{IconComponent:null,value:a.direction.type,onChange:t=>{const e=u(o);t.target.value==="direction"&&(e[l].direction={type:"direction",value:"left"}),t.target.value==="slot"&&(e[l].direction={type:"slot",slot:1}),n(e)},variant:"standard",children:["direction","slot"].map(t=>i(x,{value:t,children:t},t))}),i(w,{IconComponent:null,value:a.direction.value,variant:"standard",onChange:t=>{const e=u(o);e[l].direction.value=t.target.value,n(e)},children:["left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),a.direction.type==="slot"&&i(C,{type:"number",value:a.direction.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].direction.slot=parseInt(t.target.value)||0,n(e)}})]}),nt=(a,l,o,n)=>c("span",{children:["Goto:"," ",i(w,{IconComponent:null,value:a.step,variant:"standard",onChange:t=>{const e=u(o);e[l].step=t.target.value,n(e)},children:Object.keys(o).map(t=>i(x,{value:t,children:t},t))})]}),ot=(a,l,o,n)=>c("span",{children:["If:"," ",a.conditions.map((t,e)=>c("span",{children:[!!e&&i(w,{IconComponent:null,value:t.logic,variant:"standard",onChange:s=>{const p=u(o);p[l].conditions[e].logic=s.target.value,n(p)},children:["OR","AND"].map(s=>i(x,{value:s,children:s},s))}),i(w,{IconComponent:null,value:t.value1.type,onChange:s=>{const p=u(o);s.target.value==="myitem"&&(p[l].conditions[e].value1={type:"myitem"}),s.target.value==="direction"&&(p[l].conditions[e].value1={type:"direction",value:"left"}),s.target.value==="slot"&&(p[l].conditions[e].value1={type:"slot",slot:1}),n(p)},variant:"standard",children:["direction","myitem","slot"].map(s=>i(x,{value:s,children:s},s))}),t.value1.type==="direction"&&i(w,{IconComponent:null,value:t.value1.value,variant:"standard",onChange:s=>{const p=u(o);p[l].conditions[e].value1.value=s.target.value,n(p)},children:["left","right","top","bottom","here","top-left","top-right","bottom-left","bottom-right"].map(s=>c(x,{value:s,children:[M(s),s]},s))}),t.value1.type==="slot"&&i(C,{type:"number",value:t.value1.slot,variant:"standard",onChange:s=>{const p=u(o);p[l].conditions[e].value1.slot=parseInt(s.target.value)||0,n(p)}}),i(w,{IconComponent:null,value:t.operation,variant:"standard",onChange:s=>{const p=u(o);p[l].conditions[e].operation=s.target.value,n(p)},children:["==",">","<",">=","<="].map(s=>i(x,{value:s,children:s},s))}),i(w,{IconComponent:null,value:a.conditions[e].value2.type,onChange:s=>{const p=u(o);s.target.value==="number"&&(p[l].conditions[e].value2={type:"number",value:0}),s.target.value==="myitem"&&(p[l].conditions[e].value2={type:"myitem"}),s.target.value==="direction"&&(p[l].conditions[e].value2={type:"direction",value:"left"}),s.target.value==="slot"&&(p[l].conditions[e].value2={type:"slot",slot:1}),s.target.value==="something"&&(p[l].conditions[e].value2={type:"something"}),s.target.value==="empty"&&(p[l].conditions[e].value2={type:"empty"}),s.target.value==="hole"&&(p[l].conditions[e].value2={type:"hole"}),s.target.value==="character"&&(p[l].conditions[e].value2={type:"character"}),n(p)},variant:"standard",children:["number","direction","slot","myitem","something","empty","hole","character","box"].map(s=>i(x,{value:s,children:s},s))}),t.value2.type==="number"&&i(C,{type:"number",value:t.value2.value,variant:"standard",onChange:s=>{const p=u(o);p[l].conditions[e].value2.value=parseInt(s.target.value)||0,n(p)}}),t.value2.type==="direction"&&i(w,{IconComponent:null,value:t.value2.value,variant:"standard",onChange:s=>{const p=u(o);p[l].conditions[e].value2.value=s.target.value,n(p)},children:["left","right","top","bottom","here","top-left","top-right","bottom-left","bottom-right"].map(s=>c(x,{value:s,children:[M(s),s]},s))}),t.value2.type==="slot"&&i(C,{type:"number",value:t.value2.slot,variant:"standard",onChange:s=>{const p=u(o);p[l].conditions[e].value2.slot=parseInt(s.target.value)||0,n(p)}}),i(le,{size:"small",onMouseDown:()=>{const s=u(o);s[l].conditions.splice(e,1),n(s)},children:i(Ae,{})}),e===a.conditions.length-1&&i(le,{size:"small",onMouseDown:()=>{const s=u(o);s[l].conditions.push({value1:{type:"direction",value:"here"},operation:"==",value2:{type:"number",value:0},logic:"OR"}),n(s)},children:i(Je,{})})]},e))]}),it=()=>"Pickup",st=()=>"Drop",rt=(a,l,o,n)=>c("span",{children:["Near:"," ","slot",i(C,{type:"number",value:a.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].slot=parseInt(t.target.value)||0,n(e)}}),"=",i(w,{IconComponent:null,value:a.find,onChange:t=>{const e=u(o);e[l].find=t.target.value,n(e)},variant:"standard",children:["box","wall","hole","character","printer","shredder"].map(t=>i(x,{value:t,children:t},t))})]}),pt=(a,l,o,n)=>c("span",{children:["Variable"," ","slot",i(C,{type:"number",value:a.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].slot=parseInt(t.target.value)||0,n(e)}}),"=",i(w,{IconComponent:null,value:a.value.type,onChange:t=>{const e=u(o);t.target.value==="number"&&(e[l].value={type:"number",value:0}),t.target.value==="myitem"&&(e[l].value={type:"myitem"}),t.target.value==="direction"&&(e[l].value={type:"direction",value:"left"}),t.target.value==="slot"&&(e[l].value={type:"slot",slot:1}),n(e)},variant:"standard",children:["number","direction","slot","myitem"].map(t=>i(x,{value:t,children:t},t))}),a.value.type==="number"&&i(C,{type:"number",value:a.value.value,variant:"standard",onChange:t=>{const e=u(o);e[l].value.value=parseInt(t.target.value)||0,n(e)}}),a.value.type==="direction"&&i(w,{IconComponent:null,value:a.value.value,variant:"standard",onChange:t=>{const e=u(o);e[l].value.value=t.target.value,n(e)},children:["left","right","top","bottom","here","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),a.value.type==="slot"&&i(C,{type:"number",value:a.value.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].value.slot=parseInt(t.target.value)||0,n(e)}})]}),dt=(a,l,o,n)=>c("span",{children:["Calc"," ","slot",i(C,{type:"number",value:a.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].slot=parseInt(t.target.value)||0,n(e)}}),"=",i(w,{IconComponent:null,value:a.value1.type,onChange:t=>{const e=u(o);t.target.value==="number"&&(e[l].value1={type:"number",value:0}),t.target.value==="myitem"&&(e[l].value1={type:"myitem"}),t.target.value==="direction"&&(e[l].value1={type:"direction",value:"left"}),t.target.value==="slot"&&(e[l].value1={type:"slot",slot:1}),n(e)},variant:"standard",children:["number","direction","slot","myitem"].map(t=>i(x,{value:t,children:t},t))}),a.value1.type==="number"&&i(C,{type:"number",value:a.value1.value,variant:"standard",onChange:t=>{const e=u(o);e[l].value1.value=parseInt(t.target.value)||0,n(e)}}),a.value1.type==="direction"&&i(w,{IconComponent:null,value:a.value1.value,variant:"standard",onChange:t=>{const e=u(o);e[l].value1.value=t.target.value,n(e)},children:["left","right","top","bottom","here","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),a.value1.type==="slot"&&i(C,{type:"number",value:a.value1.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].value1.slot=parseInt(t.target.value)||0,n(e)}}),i(w,{IconComponent:null,value:a.operation,variant:"standard",onChange:t=>{const e=u(o);e[l].operation=t.target.value,n(e)},children:["+","-","*","/"].map(t=>i(x,{value:t,children:t},t))}),i(w,{IconComponent:null,value:a.value2.type,onChange:t=>{const e=u(o);t.target.value==="number"&&(e[l].value2={type:"number",value:0}),t.target.value==="myitem"&&(e[l].value2={type:"myitem"}),t.target.value==="direction"&&(e[l].value2={type:"direction",value:"left"}),t.target.value==="slot"&&(e[l].value2={type:"slot",slot:1}),n(e)},variant:"standard",children:["number","direction","slot","myitem"].map(t=>i(x,{value:t,children:t},t))}),a.value2.type==="number"&&i(C,{type:"number",value:a.value2.value,variant:"standard",onChange:t=>{const e=u(o);e[l].value2.value=parseInt(t.target.value)||0,n(e)}}),a.value2.type==="direction"&&i(w,{IconComponent:null,value:a.value2.value,variant:"standard",onChange:t=>{const e=u(o);e[l].value2.value=t.target.value,n(e)},children:["left","right","top","bottom","here","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),a.value2.type==="slot"&&i(C,{type:"number",value:a.value2.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].value2.slot=parseInt(t.target.value)||0,n(e)}})]}),ut=(a,l,o,n)=>c("span",{children:["Say:"," ",i(C,{value:a.text,variant:"standard",onChange:t=>{const e=u(o);e[l].text=t.target.value,n(e)}}),i(w,{IconComponent:null,value:a.target.type,onChange:t=>{const e=u(o);t.target.value==="direction"&&(e[l].target={type:"direction",value:"left"}),t.target.value==="slot"&&(e[l].target={type:"slot",slot:1}),t.target.value==="all"&&(e[l].target={type:"all"}),n(e)},variant:"standard",children:["direction","all","slot"].map(t=>i(x,{value:t,children:t},t))}),a.target.type==="direction"&&i(w,{IconComponent:null,value:a.target.value,variant:"standard",onChange:t=>{const e=u(o);e[l].target.value=t.target.value,n(e)},children:["left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),a.target.type==="slot"&&i(C,{type:"number",value:a.target.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].target.slot=parseInt(t.target.value)||0,n(e)}})]}),ct=(a,l,o,n)=>c("span",{children:["Hear:"," ",i(C,{value:a.text,variant:"standard",onChange:t=>{const e=u(o);e[l].text=t.target.value,n(e)}})]}),vt=(a,l,o,n)=>c("span",{children:["Foreach:"," ",i(w,{IconComponent:null,value:a.directions,variant:"standard",multiple:!0,onChange:t=>{const e=u(o);e[l].directions=t.target.value,n(e)},children:["left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),i(C,{type:"number",value:a.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].slot=parseInt(t.target.value)||0,n(e)}})]}),yt=()=>"End",mt=(a,l,o,n)=>c("span",{children:["Write"," ",i(w,{IconComponent:null,value:a.value.type,onChange:t=>{const e=u(o);t.target.value==="number"&&(e[l].value={type:"number",value:0}),t.target.value==="myitem"&&(e[l].value={type:"myitem"}),t.target.value==="direction"&&(e[l].value={type:"direction",value:"left"}),t.target.value==="slot"&&(e[l].value={type:"slot",slot:1}),n(e)},variant:"standard",children:["number","direction","slot","myitem"].map(t=>i(x,{value:t,children:t},t))}),a.value.type==="number"&&i(C,{type:"number",value:a.value.value,variant:"standard",onChange:t=>{const e=u(o);e[l].value.value=parseInt(t.target.value)||0,n(e)}}),a.value.type==="direction"&&i(w,{IconComponent:null,value:a.value.value,variant:"standard",onChange:t=>{const e=u(o);e[l].value.value=t.target.value,n(e)},children:["left","right","top","bottom","here","top-left","top-right","bottom-left","bottom-right"].map(t=>c(x,{value:t,children:[M(t),t]},t))}),a.value.type==="slot"&&i(C,{type:"number",value:a.value.slot,variant:"standard",onChange:t=>{const e=u(o);e[l].value.slot=parseInt(t.target.value)||0,n(e)}})]});function ht(a,l,o,n,t){let e=null;return a.type==="step"&&(e=tt(a,l,o,n)),a.type==="give"&&(e=at(a,l,o,n)),a.type==="take"&&(e=lt(a,l,o,n)),a.type==="goto"&&(e=nt(a,l,o,n)),a.type==="if"&&(e=ot(a,l,o,n)),a.type==="endif"&&(e="Endif"),a.type==="pickup"&&(e=it()),a.type==="drop"&&(e=st()),a.type==="near"&&(e=rt(a,l,o,n)),a.type==="variable"&&(e=pt(a,l,o,n)),a.type==="calc"&&(e=dt(a,l,o,n)),a.type==="say"&&(e=ut(a,l,o,n)),a.type==="hear"&&(e=ct(a,l,o,n)),a.type==="foreach"&&(e=vt(a,l,o,n)),a.type==="endforeach"&&(e="Endforeach"),a.type==="end"&&(e=yt()),a.type==="write"&&(e=mt(a,l,o,n)),e||(e=JSON.stringify(a)),a.type==="endif"&&(t-=20),a.type==="endforeach"&&(t-=20),e=c("span",{children:[l,": ",i("span",{style:{paddingLeft:t},children:e}),i(le,{size:"small",onMouseDown:()=>{const s=[...o],p=s[l];s.splice(l,1),p.type==="if"&&s.splice(s.findIndex(I=>I.type==="endif"&&I.ifId===p.id),1),p.type==="endif"&&s.splice(s.findIndex(I=>I.type==="if"&&I.id===p.ifId),1),p.type==="foreach"&&s.splice(s.findIndex(I=>I.type==="endforeach"&&I.foreachId===p.id),1),p.type==="endforeach"&&s.splice(s.findIndex(I=>I.type==="foreach"&&I.id===p.foreachId),1),n(s)},children:i(Fe,{fontSize:"small"})})]},l),a.type==="if"&&(t+=20),a.type==="foreach"&&(t+=20),{result:e,intend:t}}const ft=Be(({children:a})=>i("div",{children:a})),gt=Ge(({children:a})=>i("div",{children:a}));function wt(a){const[l,o]=R.exports.useState(a.level),[n,t]=R.exports.useState(a.level.characters),[e,s]=R.exports.useState(a.level.code),p=h=>{window.localStorage.setItem(`level${a.levelNumber}`,JSON.stringify(h)),s(h)},[I,Y]=R.exports.useState(!1),[V,Z]=R.exports.useState(-1),[y,g]=R.exports.useState(1e3);R.exports.useEffect(()=>{o(a.level),t(a.level.characters),window.localStorage.getItem(`level${a.levelNumber}`)?s(JSON.parse(window.localStorage.getItem(`level${a.levelNumber}`))):p(a.level.code)},[a.level]),R.exports.useEffect(()=>{if(!I)return;const h=setInterval(()=>Z(f=>f+1),y);return()=>clearInterval(h)},[y,I]),R.exports.useEffect(()=>{if(V===-1)return;const h=u(n),f=u(l),S=[];h.forEach((r,$)=>{var W,j,F,q,oe,ie,se,re,pe;if(S[$]=r.coordinates,r.terminated||(r.step++,r.step===-1))return;const d=e[r.step];if(!d)return;const O=G(r.coordinates);if(d.type==="step"){const m=Ke(d.destination.directions),v=z(O,m),b=l.cells[v.join("x")];b&&["empty","hole"].includes(b.type)&&(S[$]=v.join("x"))}else d.type==="goto"?r.step=d.step-1:d.type==="pickup"?!r.item&&((W=f.cells[r.coordinates].item)==null?void 0:W.type)==="box"&&(r.item=f.cells[r.coordinates].item,delete f.cells[r.coordinates].item):d.type==="drop"&&((j=r.item)==null?void 0:j.type)==="box"&&!f.cells[r.coordinates].item&&(f.cells[r.coordinates].item=r.item,delete r.item);if(d.type==="take"){const m=z(O,d.direction.value).join("x");!r.item&&((F=f.cells[m])==null?void 0:F.type)==="printer"&&(r.item={type:"box",value:$e(0,99)},f.cells[m].printed++)}else if(d.type==="give"){const m=z(O,d.direction.value).join("x");r.item&&((q=f.cells[m])==null?void 0:q.type)==="shredder"&&(delete r.item,f.cells[m].shredded++)}else if(d.type==="hear")r.wait=d.text,r.step--;else if(d.type==="say"){if(d.target.type==="direction"){const m=z(O,d.target.value).join("x"),v=h.find(b=>b.coordinates===m);v&&v.wait===d.text&&(v.wait="",v.step++)}d.target.type==="all"&&h.forEach(m=>{m.wait===d.text&&(m.wait="",m.step++)})}else if(d.type==="foreach")if(!r.loops.find(m=>m.id===d.id))r.loops.push({id:d.id,direction:d.directions[0],value:l.cells[z(O,d.directions[0]).join("x")]}),r.slots[d.slot]={value:{type:"number",value:(ie=(oe=l.cells[z(O,d.directions[0]).join("x")])==null?void 0:oe.item)==null?void 0:ie.value}};else{const m=r.loops.find(v=>v.id===d.id);m.direction=d.directions[d.directions.indexOf(m.direction)+1],m.value=l.cells[z(O,m.direction).join("x")],r.slots[d.slot]={value:{type:"number",value:(re=(se=l.cells[z(O,m.direction).join("x")])==null?void 0:se.item)==null?void 0:re.value}}}else if(d.type==="endforeach"){const m=e.findIndex(b=>b.type==="foreach"&&b.id===d.foreachId),v=e[m].directions;v[v.length-1]!==r.loops.find(b=>b.id===d.foreachId).direction&&(r.step=m-1)}else if(d.type==="calc"){let m=0,v=0,b=0;d.value1.type==="number"?m=d.value1.value:d.value1.type==="slot"&&(m=r.slots[d.value1.slot].value.value),d.value2.type==="number"?v=d.value1.value:d.value2.type==="slot"&&(v=r.slots[d.value2.slot].value.value),d.operation==="+"?b=m+v:d.operation==="-"?b=m-v:d.operation==="*"?b=m*v:d.operation==="/"&&(b=m/v),r.slots[d.slot]={value:{type:"number",value:b}}}else if(d.type==="variable")d.value.type==="number"&&(r.slots[d.slot]={value:d.value});else if(d.type!=="near"){if(d.type==="end")r.terminated=!0;else if(d.type==="write")((pe=r.item)==null?void 0:pe.type)==="box"&&(r.item.value=d.value.value);else if(d.type==="if"){let m=!1;if(d.conditions.forEach(v=>{var de,ue,ce,ve,ye,me,he,fe,ge,we;let b=!1,D,_,Q,H,U;if(v.value1.type==="direction"){const B=z(O,v.value1.value).join("x");D=(ue=(de=n.find(ae=>v.value1.value!=="here"&&ae.coordinates===B))==null?void 0:de.item)==null?void 0:ue.value,D===void 0&&(D=(ve=(ce=f.cells[B])==null?void 0:ce.item)==null?void 0:ve.value),Q=(ye=f.cells[B])==null?void 0:ye.type}else v.value1.type==="slot"||v.value1.type==="myitem"&&r.item&&(D=r.item.value,Q=r.item.type);if(v.value2.type==="direction"){const B=z(O,v.value2.value).join("x");_=(he=(me=n.find(ae=>v.value2.value!=="here"&&ae.coordinates===B))==null?void 0:me.item)==null?void 0:he.value,_===void 0&&(_=(ge=(fe=f.cells[B])==null?void 0:fe.item)==null?void 0:ge.value),H=(we=f.cells[B])==null?void 0:we.type,b=D===_}else v.value2.type==="slot"||(v.value2.type==="myitem"?(r.item&&(_=r.item.value,H=r.item.type),U="number"):v.value2.type==="number"?(_=v.value2.value,U="number"):(H=v.value2.type,b=Q===H,U="type"));U==="number"&&(v.operation==="=="&&(b=D===_),v.operation==="!="&&(b=D!==_),v.operation===">"&&(b=D>_),v.operation==="<"&&(b=D<_),v.operation==="<="&&(b=D<=_),v.operation===">="&&(b=D>=_)),U==="type"&&(v.operation==="=="&&(b=Q===H),v.operation==="!="&&(b=Q!==H)),v.logic==="OR"?m=m||b:m=m&&b}),!m){let v=0;for(v=r.step;v<e.length&&e[v].type!=="endif";v++);r.step=v}}}}),h.forEach((r,$)=>{!e[r.step]||(!n.find(O=>O.coordinates===S[$])||n.find((O,W)=>O.coordinates===S[$]&&r.coordinates===S[W])?(r.coordinates=S[$],l.cells[r.coordinates].type==="hole"&&(r.terminated=!0)):e[r.step].type==="step"&&r.step--)});const k=[];h.forEach((r,$)=>{var O;const d=e[r.step];if(!!d&&!k.includes(r.name)&&d.type==="give"&&((O=r.item)==null?void 0:O.type)==="box"){const W=z(G(r.coordinates),d.direction.value),j=h.find(q=>q.coordinates===W.join("x")),F=j?e[j.step]:null;if(j)if(!j.item)j.item=r.item,delete r.item,k.push(j.name);else if(j.item&&(F==null?void 0:F.type)==="give"&&z(G(j.coordinates),F.direction.value).join("x")===r.coordinates){const q=r.item;r.item=j.item,j.item=q,k.push(j.name)}else r.step--}}),t(h),o(f)},[V]);let L=0;const P=R.exports.useMemo(()=>e.map((h,f)=>{const S=ht(h,f,e,p,L);return L=S.intend,S.result}),[e]);return c(N,{container:!0,children:[c(N,{item:!0,md:6,children:[i("h2",{children:l.task}),i("h4",{children:I&&a.level.win(l.cells,n)?"Win":null}),i(Re,{cells:l.cells,characters:n,width:l.width,height:l.height,run:I,speed:y})]}),i(N,{item:!0,md:1,children:i(et,{code:e,setCode:p})}),i(N,{item:!0,md:5,children:c("div",{style:{paddingLeft:20},children:[i(gt,{onSortEnd:({oldIndex:h,newIndex:f},S)=>{if(S.ctrlKey){const k=u(e);k.splice(f,0,e[h]),p(k)}else{const k=Pe(e,h,f),r=[];if(k.forEach($=>{$.type==="if"&&r.push($.id),$.type==="endif"&&r[r.length-1]===$.ifId&&r.splice(r.indexOf($.ifId),1),$.type==="foreach"&&r.push($.id),$.type==="endforeach"&&r[r.length-1]===$.foreachId&&r.splice(r.indexOf($.foreachId),1)}),r.length)return;p(k)}},children:e.map((h,f)=>c(ft,{index:f,children:[n.filter(k=>k.step===f).map(k=>i("span",{children:i(X,{fontSize:"small",style:{color:k.color}})},k.name)),P[f]]},f))}),c("div",{style:{paddingTop:20},children:["Speed:"," ",i(C,{variant:"standard",type:"number",value:1e3/y,onChange:h=>g(1e3/(parseInt(h.target.value)||1))})]}),c("div",{style:{display:"flex",gap:4},children:[i("div",{children:i(A,{variant:"contained",onClick:()=>{const h=u(a.level);I||Object.values(h.cells).forEach(S=>{var k;((k=S.item)==null?void 0:k.isRandom)&&(S.item.value=$e(0,99))}),o(h);const f=u(a.level.characters);f.forEach(S=>{S.slots=[{value:{type:"number",value:0}},{value:{type:"number",value:0}},{value:{type:"number",value:0}},{value:{type:"number",value:0}}],S.loops=[]}),t(f),Y(!I)},disabled:L!==0,children:I?"Stop":"Run"})}),i("div",{children:i(A,{variant:"contained",onClick:()=>ee(JSON.stringify(e,null,2)),children:"Copy"})}),i("div",{children:i(A,{variant:"contained",onClick:()=>{window.localStorage.setItem(`level${a.levelNumber}`,JSON.stringify(a.level.code)),p(a.level.code)},children:"Clear"})})]}),n.map(h=>{var f;return c("div",{children:[h.name," ",i("span",{style:{color:h.color},children:i(X,{fontSize:"small"})})," ",(f=h.slots)==null?void 0:f.map((S,k)=>{var r;return c("span",{children:[(r=S.value)==null?void 0:r.value," "]},k)})]},h.name)})]})})]})}const xt={task:"Remove two boxes",width:5,height:7,cells:J(`box|1 box|1 empty box|1 empty
empty empty wall box|2 empty
empty empty wall box|3 empty
empty empty empty box|4 empty
empty empty empty box|5 empty
hole hole
hole hole`),characters:[{coordinates:"0x0",name:"first",color:"red",step:-1},{coordinates:"1x0",name:"second",color:"green",step:-1}],code:[],win:(a,l)=>Object.values(a).filter(o=>{var n;return((n=o.item)==null?void 0:n.type)==="box"}).length+l.filter(o=>{var n;return!o.terminated&&((n=o.item)==null?void 0:n.type)==="box"}).length===5},bt={task:"Move boxes",width:5,height:5,cells:J(`box|1 box|1 empty box|1 empty
empty empty wall box|2 empty
empty empty wall box|3 empty
empty empty empty box|4 empty
empty empty empty box|5 empty`),characters:[{coordinates:"0x0",name:"first",color:"red",step:-1},{coordinates:"1x0",name:"second",color:"green",step:-1}],code:[{type:"step",destination:{type:"direction",directions:["left","right","top","bottom"]}},{type:"step",destination:{type:"direction",directions:["left","right","top","bottom"]}},{type:"pickup"},{type:"step",destination:{type:"direction",directions:["left","right","top","bottom"]}},{type:"step",destination:{type:"direction",directions:["left","right","top","bottom"]}},{type:"drop"},{type:"goto",step:0}],win:(a,l)=>Object.values(a).filter(o=>{var n;return((n=o.item)==null?void 0:n.type)==="box"}).length+l.filter(o=>{var n;return((n=o.item)==null?void 0:n.type)==="box"}).length===5},Ct={task:"Remove only box with 2",width:5,height:7,cells:J(`empty empty empty empty empty
box|2|tag2 box|1|tag1 wall empty empty
empty empty wall empty empty
empty empty empty empty empty
empty empty empty empty empty
hole hole
hole hole`),characters:[{coordinates:"0x0",name:"first",color:"red",step:-1},{coordinates:"1x0",name:"second",color:"green",step:-1}],code:[{type:"step",destination:{type:"direction",directions:["bottom"]}},{type:"if",conditions:[{value1:{type:"direction",value:"here"},operation:">",value2:{type:"number",value:1},logic:"OR"}],id:"if1"},{type:"pickup"},{type:"endif",ifId:"if1"},{type:"goto",step:0}],win:(a,l)=>(Object.values(a).find(o=>{var n;return((n=o.item)==null?void 0:n.tag)==="tag1"})||l.find(o=>{var n;return((n=o.item)==null?void 0:n.tag)==="tag1"}))&&!(Object.values(a).find(o=>{var n;return((n=o.item)==null?void 0:n.tag)==="tag2"})||l.find(o=>{var n;return!o.terminated&&((n=o.item)==null?void 0:n.tag)==="tag2"}))},It={task:"Diagonal boxes",width:5,height:7,cells:J(`empty empty empty empty empty
box|1 box|1 box|1 box|1 box|1
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty`),characters:[{coordinates:"1x1",name:"first",color:"red",step:-1},{coordinates:"2x1",name:"second",color:"green",step:-1},{coordinates:"3x1",name:"3",color:"yellow",step:-1},{coordinates:"4x1",name:"4",color:"blue",step:-1}],code:[],win:(a,l)=>[0,1,2,3,4].every(o=>{var n;return((n=a[`${o}x${o+1}`].item)==null?void 0:n.type)==="box"})},St={task:"Sort numbers",width:5,height:5,cells:J(`empty empty empty empty empty
box|random box|0 box|random box|random box|random
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty`),characters:[{coordinates:"0x1",name:"1",color:"purple",step:-1},{coordinates:"1x1",name:"2",color:"red",step:-1},{coordinates:"2x1",name:"3",color:"green",step:-1},{coordinates:"3x1",name:"4",color:"yellow",step:-1},{coordinates:"4x1",name:"5",color:"blue",step:-1}],code:[{type:"pickup"},{type:"if",id:"if1",conditions:[{value1:{type:"direction",value:"right"},operation:"<",value2:{type:"myitem"},logic:"OR"}]},{type:"give",direction:{type:"direction",value:"right"}},{type:"endif",ifId:"if1"},{type:"if",id:"if2",conditions:[{value1:{type:"direction",value:"left"},operation:">",value2:{type:"myitem"},logic:"OR"}]},{type:"give",direction:{type:"direction",value:"left"}},{type:"endif",ifId:"if2"},{type:"goto",step:1}],win:(a,l)=>[0,1,2,3,4].every(o=>{var n,t,e,s;return o===0||((t=(n=Oe(l,`${o}x1`))==null?void 0:n.item)==null?void 0:t.value)>=((s=(e=Oe(l,`${o-1}x1`))==null?void 0:e.item)==null?void 0:s.value)})},kt={task:"Print and shred 10 boxes",width:5,height:5,cells:J(`empty empty empty empty empty
empty empty empty empty empty
empty printer shredder empty empty
empty empty empty empty empty
empty empty empty empty empty`),characters:[{coordinates:"1x1",name:"first",color:"red",step:-1},{coordinates:"2x1",name:"second",color:"green",step:-1}],code:[],win:(a,l)=>a["2x2"].shredded>=10},$t={task:"Print and shred 10 boxes (no move)",width:7,height:5,cells:J(`hole hole hole hole hole hole hole
hole empty empty empty empty empty hole
hole printer hole hole hole shredder hole
hole hole hole hole hole hole hole
hole hole hole hole hole hole hole`),characters:[{coordinates:"1x1",name:"1",color:"purple",step:-1},{coordinates:"2x1",name:"2",color:"red",step:-1},{coordinates:"3x1",name:"3",color:"green",step:-1},{coordinates:"4x1",name:"4",color:"yellow",step:-1},{coordinates:"5x1",name:"5",color:"blue",step:-1}],code:[],win:(a,l)=>a["5x2"].shredded>=10},te=[xt,bt,Ct,It,St,kt,$t];function Ot(a){var V,Z;const[l,o]=R.exports.useState({cells:J("empty"),code:[],characters:[],height:1,width:1,task:"",win:(y,g)=>!1}),[n,t]=R.exports.useState(!1),e=l.cells[n],[s,p]=R.exports.useState(0),I=(y,g)=>{const L=u(l);for(let P=0;P<y;P++)for(let h=0;h<g;h++)L.cells[`${P}x${h}`]||(L.cells[`${P}x${h}`]={type:"nothing"});L.width=y,L.height=g,o(L)},Y=`{
        task: ${JSON.stringify(l.task)},
        code: [],
        cells: \`${ne(l.cells)}\`,
        characters: ${JSON.stringify(l.characters,null,2)},
        width: ${l.width},
        height: ${l.height},
        win: ${((V=l.win)==null?void 0:V.toString())||"null"}
    }`;return c("div",{children:[c("div",{children:[i(w,{variant:"standard",value:s,onChange:y=>p(parseInt(y.target.value)),children:te.map((y,g)=>i(x,{value:g,children:y.task},g))}),i(A,{onClick:()=>o(te[s]),children:"Import"})]}),c("div",{children:[i(C,{label:"width",value:l.width,variant:"standard",onChange:y=>I(parseInt(y.target.value),l.height)}),i(C,{label:"height",value:l.height,variant:"standard",onChange:y=>I(l.width,parseInt(y.target.value))}),i(A,{onClick:()=>{const y=u(l);Object.keys(y.cells).forEach(g=>{const L=G(g);(L[0]>y.width-1||L[1]>y.height-1)&&delete y.cells[g]}),o(y)},children:"Crop"})]}),i(Re,{cells:l.cells,characters:l.characters,width:l.width,height:l.height,run:!1,speed:0,onClick:y=>t(y)}),c("div",{children:[c("div",{children:[i(A,{onClick:()=>ee(ne(l.cells)),children:"Copy cells"}),i(A,{onClick:()=>ee(JSON.stringify(l.characters,null,2)),children:"Copy characters"}),i(A,{onClick:()=>ee(Y),children:"Copy level"})]}),c("pre",{children:[i("div",{children:Y}),i("div",{children:ne(l.cells)}),i("div",{children:JSON.stringify(l,(y,g)=>typeof g=="function"?`${g}`:g,2)})]})]}),c(We,{open:n!==!1,onClose:()=>t(!1),children:[i(qe,{children:n}),c(He,{children:[i("div",{children:i(w,{value:e==null?void 0:e.type,onChange:y=>{const g=u(l);g.cells[n].type=y.target.value,o(g)},children:["nothing","empty","printer","shredder","wall"].map(y=>i(x,{value:y,children:y},y))})}),(e==null?void 0:e.type)==="empty"?c("div",{children:["Item:"," ",i(Se,{checked:!!(e==null?void 0:e.item),onChange:y=>{const g=u(l);g.cells[n].item=y.target.checked?{type:"box",value:0}:null,o(g)}})]}):null,(e==null?void 0:e.item)?i("div",{children:i(C,{label:"Item value",value:(Z=e==null?void 0:e.item)==null?void 0:Z.value,variant:"standard",onChange:y=>{const g=u(l);g.cells[n].item.value=parseInt(y.target.value),o(g)}})}):null,(e==null?void 0:e.type)==="empty"?c("div",{children:["Character:"," ",i(Se,{checked:!!l.characters.find(y=>y.coordinates===n),onChange:y=>{const g=u(l);y.target.checked?g.characters.push({color:"green",name:`${g.characters.length+1}`,step:-1,coordinates:n}):g.characters.splice(g.characters.findIndex(L=>L.coordinates===n),1),o(g)}})]}):null]})]})]})}const Rt=Ve({components:{MuiTextField:{styleOverrides:{root:{width:"50px","& input":{textAlign:"center"}}}},MuiSelect:{styleOverrides:{select:{paddingLeft:"24px"}}}}});function Lt(){const[a,l]=R.exports.useState(0),[o,n]=R.exports.useState(!1);return i(Qe,{theme:Rt,children:c("div",{className:"App",children:[i("h1",{children:"Open7BH"}),c(Ue,{value:o?1:0,onChange:(t,e)=>n(e===1),children:[i(ke,{label:"Game"}),i(ke,{label:"Editor"})]}),o?i(Ot,{}):c(K,{children:[i("div",{children:i(w,{variant:"standard",value:a,onChange:t=>l(parseInt(t.target.value)),children:te.map((t,e)=>i(x,{value:e,children:t.task},e))})}),i(wt,{level:te[a],levelNumber:a})]})]})})}const jt="modulepreload",Le={},Et="./",_t=function(l,o){return!o||o.length===0?l():Promise.all(o.map(n=>{if(n=`${Et}${n}`,n in Le)return;Le[n]=!0;const t=n.endsWith(".css"),e=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${e}`))return;const s=document.createElement("link");if(s.rel=t?"stylesheet":jt,t||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),t)return new Promise((p,I)=>{s.addEventListener("load",p),s.addEventListener("error",I)})})).then(()=>l())},zt=a=>{a&&a instanceof Function&&_t(()=>import("./web-vitals.67dce932.js"),[]).then(({getCLS:l,getFID:o,getFCP:n,getLCP:t,getTTFB:e})=>{l(a),o(a),n(a),t(a),e(a)})},Dt=Xe.createRoot(document.getElementById("root"));Dt.render(i(Ye.StrictMode,{children:i(Lt,{})}));zt();
