import{v as Ne,d as ee,a as te,b as Le,c as ze,e as ke,f as Ee,g as Te,h as Oe,j as n,i as h,F as _,k as re,l as F,B as z,S as b,M as g,T as j,m as le,I as J,n as Re,o as Me,p as $e,s as Fe,q as Ue,r as T,G as H,t as A,D as Ge,u as Pe,w as _e,C as se,x as He,y as Ae,z as We,A as ie,E as qe,R as Be}from"./vendor.c8e954cd.js";const Je=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function l(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(s){if(s.ep)return;s.ep=!0;const i=l(s);fetch(s.href,i)}};Je();var o;(function(r){r.Calc="calc",r.Pickup="pickup",r.Drop="drop",r.End="end",r.Foreach="foreach",r.EndForeach="endforeach",r.Give="give",r.Goto="goto",r.Hear="hear",r.If="if",r.EndIf="endif",r.Near="near",r.Say="say",r.Step="step",r.Take="take",r.Variable="variable",r.Write="write"})(o||(o={}));class C{constructor(e){this.level=e,this.id=Ne()}prepare(e){}remove(){}postDeserialize(){}}var p;(function(r){r.Up="Up",r.Down="Down",r.Left="Left",r.Right="Right",r.UpLeft="UpLeft",r.UpRight="UpRight",r.DownLeft="DownLeft",r.DownRight="DownRight"})(p||(p={}));var v;(function(r){r.Up="Up",r.Down="Down",r.Left="Left",r.Right="Right",r.UpLeft="UpLeft",r.UpRight="UpRight",r.DownLeft="DownLeft",r.DownRight="DownRight",r.Here="Here"})(v||(v={}));var x;(function(r){r.Direction="Direction",r.Slot="Slot",r.Near="Near"})(x||(x={}));class ne extends C{constructor(e){super(e);this.type=x.Direction,this.directions=[p.Down]}setDirection(e){this.type=x.Direction,this.directions=e}setSlot(e){this.type=x.Slot,this.slot=e}prepare(e){if(this.type===x.Direction){const l=Qe(this.directions);e.prepareMove(l)}if(this.type===x.Slot&&e.slots[this.slot].getCellValue()){const l=this.level.findNear([e.cell.x,e.cell.y],t=>t===e.slots[this.slot].getCellValue());console.log(e.slots[this.slot].getCellValue()),console.log(l),l.length>1&&l[1]&&(e.nextMove=l[1])}}execute(e){return this.type===x.Slot&&e.nextMove?e.currentLine:e.currentLine+1}serialize(e){return{type:o.Step,stepType:this.type,directions:this.directions,slot:this.slot,object:e?this:void 0}}deserialize(e){this.type=e.stepType,this.directions=e.directions,this.slot=e.slot}}const ae=r=>r.split("x").map(e=>parseInt(e)),Qe=r=>r[Math.floor(Math.random()*r.length)],k=r=>{const l={[v.Left]:ee,[v.Right]:te,[v.Up]:Le,[v.Down]:ze,[v.UpLeft]:ke,[v.UpRight]:Ee,[v.DownLeft]:Te,[v.DownRight]:Oe,[v.Here]:null}[r];return l?n(l,{fontSize:"small"}):null};class Q{constructor(e,l,t,s){this.isRandom=!1,this.value=0,this.tag=null,this.value=e,this.isRandom=l,l&&(this.value=Math.floor(Math.random()*(s-t+1))+t)}setTag(e){this.tag=e}}var f;(function(r){r.Empty="empty",r.Wall="wall",r.Hole="hole",r.Printer="printer",r.Shredder="shredder"})(f||(f={}));class U{constructor(e,l,t){this.character=null,this.item=null,this.isEmpty=!1,this.level=e,this.x=l,this.y=t}getCharacter(){return this.character}setCharacter(e){this.isEmpty&&(e.cell&&(e.cell.character=null),this.character=e,e.cell=this)}getItem(){return this.item}setItem(e){this.item=e}removeItem(){this.item=null}}class oe{constructor(e){this.character=e}getNumberValue(){return 0}getCellValue(){}getCharacterValue(){}}class X extends oe{constructor(){super(...arguments);this.number=0}setNumber(e){this.number=e}getNumberValue(){return this.number}}class W extends U{constructor(e,l,t,s,i){super(e,l,t);this.isEmpty=!0,this.min=0,this.max=99,this.min=s||0,this.max=i||99}print(){return Math.floor(Math.random()*(this.max-this.min+1))+this.min}getType(){return f.Printer}}class q extends U{constructor(){super(...arguments);this.isEmpty=!0,this.shredded=0}getType(){return f.Shredder}shred(){this.shredded++}}class ce{constructor(e,l){this.color="green",this.item=null,this.isTerminated=!1,this.isDead=!1,this.slots=[],this.currentLine=0,this.operationDone=!1,this.foreachLoops=[],this.cell=e,this.name=l;for(let t=0;t<4;t++)this.slots.push(new X(this))}prepareMove(e){this.nextMove=this.getMoveCell(e,!0)}prepare(){if(this.isTerminated||this.hear)return;const e=this.cell.level.game.code;if(this.currentLine>=e.length)return;e[this.currentLine].prepare(this)}update(){if(this.isTerminated)return;if(this.operationDone){this.operationDone=!1;return}if(this.hear)return;const e=this.cell.level.game.code;if(this.currentLine>=e.length)return;const l=e[this.currentLine];this.currentLine=l.execute(this),this.currentLine>=e.length&&(this.isTerminated=!0),this.operationDone=!1}setItem(e){this.item=e}giveItem(e){const l=this.cell.level.getMoveCell(this.cell.x,this.cell.y,e);l&&l.character&&!l.character.item&&this.item&&(l.character.setItem(this.item),l.character.operationDone=!0,this.item=null),l&&l instanceof q&&this.item&&(l.shred(),this.item=null)}take(e){const l=this.cell.level.getMoveCell(this.cell.x,this.cell.y,e);l&&l instanceof W&&!this.item&&(this.item=new Q(l.print()))}write(e){this.item&&(this.item.value=e)}pickupItem(){const e=this.cell.getItem();e&&!this.item&&(this.setItem(e),this.cell.removeItem())}dropItem(){this.item&&!this.cell.getItem()&&(this.cell.setItem(this.item),this.item=null)}getMoveCell(e,l=!1){const t=this.cell.level.getMoveCell(this.cell.x,this.cell.y,e);return t&&t.isEmpty&&(l||!t.character)?t:void 0}say(e,l){const t=this.cell.level.getMoveCell(this.cell.x,this.cell.y,l);t&&t.character&&t.character.hear===e&&(t.character.hear=null,t.character.currentLine++)}terminate(){this.isTerminated=!0}die(){this.isDead=!0,this.terminate(),this.cell.character=null}}class B extends U{constructor(){super(...arguments);this.isEmpty=!0}getType(){return f.Empty}}class Y extends U{constructor(){super(...arguments);this.isEmpty=!0}getType(){return f.Hole}}class Z extends U{constructor(){super(...arguments);this.isEmpty=!0}getType(){return f.Wall}}class E{constructor(e){this.cells={},this.game=e}serialize(e){const l={task:this.task,width:this.width,height:this.height,cells:[],winCallback:this.winCallback,object:e?this:void 0};return Object.values(this.cells).forEach(t=>{const s=t.getCharacter();l.cells.push({x:t.x,y:t.y,type:t.getType(),character:s?{name:s.name,color:s.color,coordinates:[t.x,t.y],object:e?s:void 0}:null,item:t.getItem()?{isRandom:t.getItem().isRandom,value:t.getItem().value,tag:t.getItem().tag}:void 0,object:e?t:void 0})}),l}deserialize(e){this.task=e.task,this.width=e.width,this.height=e.height,this.winCallback=e.winCallback,e.cells.forEach(l=>{let t;l.type===f.Empty&&(t=new B(this,l.x,l.y)),l.type===f.Hole&&(t=new Y(this,l.x,l.y)),l.type===f.Printer&&(t=new W(this,l.x,l.y)),l.type===f.Shredder&&(t=new q(this,l.x,l.y)),l.type===f.Wall&&(t=new Z(this,l.x,l.y)),l.character&&t.setCharacter(new ce(t,l.character.name)),l.item&&(t.setItem(new Q(l.item.value,l.item.isRandom)),l.item.tag&&(t.getItem().tag=l.item.tag)),this.addCell(l.x,l.y,t)})}addCharacter(e,l,t){this.getCell(l,t).setCharacter(e)}moveCharacters(){const e=this.getCharacters().filter(t=>t.nextMove),l=[...e];for(;l.length;)l.forEach(t=>{const s=t.nextMove;if(s&&!s.character){console.log(t.name,"move to empty"),t.cell.character=null,t.cell=s,s.character=t,l.splice(l.indexOf(t),1),t.nextMove=null;return}if(s&&s.character&&s.character.nextMove&&s.character.nextMove===t.cell){const i=t.cell,a=s.character.cell,u=t,d=s.character;i.character=d,a.character=u,u.cell=a,d.cell=i,l.splice(l.indexOf(t),1),l.splice(l.indexOf(s.character),1),u.nextMove=null,d.nextMove=null;return}s&&s.character&&!s.character.nextMove&&(console.log(t.name,"move to character",s.character.name),l.splice(l.indexOf(t),1),t.nextMove=null)});e.forEach(t=>{t.cell.getType()===f.Hole&&t.die()}),console.log(this.getCharacters().filter(t=>t.nextMove))}addCell(e,l,t){this.cells[`${e}x${l}`]=t}getCell(e,l){return this.cells[`${e}x${l}`]}getMoveCell(e,l,t){if(t===v.Here)return this.getCell(e,l);if(t===v.Up)return this.getCell(e,l-1);if(t===v.Down)return this.getCell(e,l+1);if(t===v.Left)return this.getCell(e-1,l);if(t===v.Right)return this.getCell(e+1,l);if(t===v.UpLeft)return this.getCell(e-1,l-1);if(t===v.UpRight)return this.getCell(e+1,l-1);if(t===v.DownLeft)return this.getCell(e-1,l+1);if(t===v.DownRight)return this.getCell(e+1,l+1)}getCharacters(){return Object.values(this.cells).map(e=>e.getCharacter()).filter(e=>e!==null)}findNear(e,l){const t=[],s={[`${e[0]}x${e[1]}`]:0};if(this.markNearRecursive(e,l,1,s,t),t.length){t.sort((a,u)=>s[a]-s[u]);const i=this.getPathRecursive(this.cells[t[0]],s);return i.reverse(),i}return[]}getPathRecursive(e,l={},t=[]){if(t.push(e),l[`${e.x}x${e.y}`]===0)return t;for(const s in Object.values(p)){const i=Object.values(p)[s],a=this.getMoveCell(e.x,e.y,i);if(a&&l[`${a.x}x${a.y}`]===l[`${e.x}x${e.y}`]-1)return this.getPathRecursive(a,l,t)}return t}markNearRecursive(e,l,t,s={},i=[]){if(this.cells[`${e[0]}x${e[1]}`])for(const a in Object.values(p)){const u=Object.values(p)[a],d=this.getMoveCell(e[0],e[1],u);if(!!d&&!(d.getType()!==f.Empty&&!l(d))&&!(s[`${d.x}x${d.y}`]!==void 0&&s[`${d.x}x${d.y}`]<=t)){if(s[`${d.x}x${d.y}`]=t,d&&l(d)){i.push(`${d.x}x${d.y}`);return}this.markNearRecursive([d.x,d.y],l,t+1,s,i)}}}changeSize(e,l){for(let t=0;t<e;t++)for(let s=0;s<l;s++)this.cells[`${t}x${s}`]||(this.cells[`${t}x${s}`]=new B(this,t,s));this.width=e,this.height=l}crop(e,l){Object.keys(this.cells).forEach(t=>{const s=t.split("x");(parseInt(s[0])>=e||parseInt(s[1])>=l)&&delete this.cells[t]}),this.width=e,this.height=l}}E.parseCells=(r,e)=>{const l=[];return r.split(/[\r\n]+/).forEach((t,s)=>{t.split(/ +/).forEach((i,a)=>{const u=i.split("|"),d={type:f.Empty,x:a,y:s,character:void 0};u[0]==="box"&&(d.item={value:parseInt(u[1]),isRandom:u[1]==="random",tag:u[2]}),u[0]==="hole"&&(d.type=f.Hole),u[0]==="wall"&&(d.type=f.Wall),u[0]==="printer"&&(d.type=f.Printer),u[0]==="shredder"&&(d.type=f.Shredder);const D=e.find(c=>c.coordinates[0]===a&&c.coordinates[1]===s);D&&(d.character=D),l.push(d)})}),l};var O;(function(r){r.Add="+",r.Subtract="-",r.Multiply="*",r.Divide="/"})(O||(O={}));var y;(function(r){r.Number="number",r.Direction="direction",r.Slot="slot"})(y||(y={}));class he extends C{constructor(){super(...arguments);this.operand1type=y.Number,this.operand1NumberValue=0,this.operand1DirectionValue=v.Up,this.operand1SlotValue=0,this.operator=O.Add,this.operand2type=y.Number,this.operand2NumberValue=0,this.operand2DirectionValue=v.Up,this.operand2SlotValue=0,this.slotResult=0}execute(e){var a,u,d,D;let l=0,t=0,s=0;this.operand1type===y.Number&&(l=this.operand1NumberValue),this.operand1type===y.Direction&&(l=((u=(a=this.level.getMoveCell(e.cell.x,e.cell.y,this.operand1DirectionValue))==null?void 0:a.item)==null?void 0:u.value)||0),this.operand1type===y.Slot&&(l=e.slots[this.operand1SlotValue].getNumberValue()),this.operand2type===y.Number&&(t=this.operand2NumberValue),this.operand2type===y.Direction&&(t=((D=(d=this.level.getMoveCell(e.cell.x,e.cell.y,this.operand2DirectionValue))==null?void 0:d.item)==null?void 0:D.value)||0),this.operand2type===y.Slot&&(t=e.slots[this.operand2SlotValue].getNumberValue()),this.operator===O.Add?s=l+t:this.operator===O.Subtract?s=l-t:this.operator===O.Multiply?s=l*t:this.operator===O.Divide&&(s=l/t);const i=new X(e);return i.setNumber(s),e.slots[this.slotResult]=i,e.currentLine+1}setOperand1Number(e){this.operand1type=y.Number,this.operand1NumberValue=e}setOperand1Direction(e){this.operand1type=y.Direction,this.operand1DirectionValue=e}setOperand1Slot(e){this.operand1type=y.Slot,this.operand1SlotValue=e}setOperand2Number(e){this.operand2type=y.Number,this.operand2NumberValue=e}setOperand2Direction(e){this.operand2type=y.Direction,this.operand2DirectionValue=e}setOperand2Slot(e){this.operand2type=y.Slot,this.operand2SlotValue=e}serialize(e=!1){return{type:o.Calc,operand1type:this.operand1type,operand1NumberValue:this.operand1NumberValue,operand1DirectionValue:this.operand1DirectionValue,operand1SlotValue:this.operand1SlotValue,operator:this.operator,operand2type:this.operand2type,operand2NumberValue:this.operand2NumberValue,operand2DirectionValue:this.operand2DirectionValue,operand2SlotValue:this.operand2SlotValue,slotResult:this.slotResult,object:e?this:void 0}}deserialize(e){this.operand1type=e.operand1type,this.operand1NumberValue=e.operand1NumberValue,this.operand1DirectionValue=e.operand1DirectionValue,this.operand1SlotValue=e.operand1SlotValue,this.operator=e.operator,this.operand2type=e.operand2type,this.operand2NumberValue=e.operand2NumberValue,this.operand2DirectionValue=e.operand2DirectionValue,this.operand2SlotValue=e.operand2SlotValue,this.slotResult=e.slotResult}}class de extends C{execute(e){return e.dropItem(),e.currentLine+1}serialize(e){return{type:o.Drop,object:e?this:void 0}}deserialize(e){}}class ue extends C{execute(e){return e.terminate(),e.currentLine}serialize(e){return{type:o.End,object:e?this:void 0}}deserialize(e){}}class pe extends C{execute(e){const l=this.level.game.code.find(a=>a.id===this.operatorForeach.id),t=l.directions,s=e.foreachLoops[this.operatorForeach.id];return t.indexOf(s)===t.length-1?(e.foreachLoops[this.operatorForeach.id]=void 0,e.currentLine+1):this.level.game.code.findIndex(a=>a===l)}serialize(e){return{type:o.EndForeach,id:this.id,operatorForeach:this.operatorForeach.id,object:e?this:void 0}}deserialize(e){this.id=e.id,this.operatorForeachId=e.operatorForeach}postDeserialize(){this.operatorForeach=this.level.game.code.find(e=>e.id===this.operatorForeachId)}}class me extends C{remove(){const e=this.level.game.code.findIndex(l=>l===this.operatorIf);this.level.game.code.splice(e,1)}execute(e){return e.currentLine+1}serialize(e){return{type:o.EndIf,id:this.id,operatorIf:this.operatorIf.id,object:e?this:void 0}}deserialize(e){this.id=e.id,this.operatorIfId=e.operatorIf}postDeserialize(){this.operatorIf=this.level.game.code.find(e=>e.id===this.operatorIfId)}}class G extends oe{setCell(e){this.cellValue=e}getCellValue(){return this.cellValue}getNumberValue(){var e,l;return((l=(e=this.cellValue)==null?void 0:e.item)==null?void 0:l.value)||0}}class ve extends C{constructor(){super(...arguments);this.directions=[],this.slotNumber=0}execute(e){if(e.foreachLoops[this.id]){const l=this.directions,t=e.foreachLoops[this.id],s=l.indexOf(t);e.foreachLoops[this.id]=l[s+1];const i=new G(e);i.setCell(this.level.getMoveCell(e.cell.x,e.cell.y,l[s+1])),e.slots[this.slotNumber]=i}else{e.foreachLoops[this.id]=this.directions[0];const l=new G(e);l.setCell(this.level.getMoveCell(e.cell.x,e.cell.y,this.directions[0])),e.slots[this.slotNumber]=l}return e.currentLine+1}createEndForeach(){const e=new pe(this.level);return e.operatorForeach=this,this.operatorEndForeach=e,e}setDirections(e){this.directions=e}serialize(e){return{type:o.Foreach,id:this.id,operatorEndForeach:this.operatorEndForeach.id,directions:this.directions,slotNumber:this.slotNumber,object:e?this:void 0}}deserialize(e){this.id=e.id,this.operatorEndForeachId=e.operatorEndForeach,this.directions=e.directions,this.slotNumber=e.slotNumber}postDeserialize(){this.operatorEndForeach=this.level.game.code.find(e=>e.id===this.operatorEndForeachId)}}class fe extends C{constructor(e){super(e);this.direction=p.Down}setDirection(e){this.direction=e}execute(e){return e.giveItem(this.direction),e.currentLine+1}serialize(e){return{type:o.Give,direction:this.direction,slot:this.slot,object:e?this:void 0}}deserialize(e){this.direction=e.direction,this.slot=e.slot}}class ye extends C{constructor(){super(...arguments);this.line=0}execute(e){return this.line}setLine(e){this.line=e}serialize(e){return{type:o.Goto,line:this.line,object:e?this:void 0}}deserialize(e){this.line=e.line}}class be extends C{execute(e){return e.hear=this.hear,e.currentLine+1}setHear(e){this.hear=e}serialize(e){return{type:o.Hear,hear:this.hear,object:e?this:void 0}}deserialize(e){this.hear=e.hear}}var S;(function(r){r.Eq="eq",r.Ne="ne",r.Gt="gt",r.Ge="ge",r.Lt="lt",r.Le="le"})(S||(S={}));var M;(function(r){r.And="and",r.Or="or"})(M||(M={}));var w;(function(r){r.Direction="direction",r.Number="number",r.Slot="slot",r.MyItem="myItem"})(w||(w={}));var I;(function(r){r.Direction="direction",r.Number="number",r.Slot="slot",r.MyItem="myItem",r.Box="box",r.Printer="printer",r.Shredder="shredder",r.Character="character",r.Hole="hole"})(I||(I={}));class ge extends C{constructor(e){super(e);this.conditions=[],this.conditions.push({type:S.Eq,leftType:w.Number,leftNumber:0,leftSlot:null,rightType:I.Number,rightNumber:0,rightSlot:null,logic:M.Or})}checkCondition(e){let l=!1;return this.conditions.forEach(t=>{var a,u,d,D;let s=!1;const i=t.type===S.Eq;if(t.rightType===I.Box)t.leftType===w.MyItem&&(s=!!e.item,i||(s=!s)),t.leftType===w.Slot&&e.slots[t.leftSlot]instanceof G&&(s=!!e.slots[t.leftSlot].cellValue.item,i||(s=!s)),t.leftType===w.Direction&&(s=!!this.level.getMoveCell(e.cell.x,e.cell.y,t.leftDirection).item,i||(s=!s));else if(t.rightType===I.Printer||t.rightType===I.Shredder||t.rightType===I.Hole)t.leftType===w.Slot&&e.slots[t.leftSlot]instanceof G&&(s=e.slots[t.leftSlot].cellValue.getType()===t.rightType,i||(s=!s)),t.leftType===w.Direction&&(s=this.level.getMoveCell(e.cell.x,e.cell.y,t.leftDirection).getType()===t.rightType,i||(s=!s));else{let c=0,m=0;switch(t.leftType===w.Number?c=t.leftNumber:t.leftType===w.Slot?c=e.slots[t.leftSlot].getNumberValue():t.leftType===w.MyItem?c=((a=e.item)==null?void 0:a.value)||0:t.leftType===w.Direction&&(c=((u=this.level.getMoveCell(e.cell.x,e.cell.y,t.leftDirection).item)==null?void 0:u.value)||0),t.rightType===I.Number?m=t.rightNumber:t.rightType===I.Slot?m=e.slots[t.rightSlot].getNumberValue():t.rightType===I.MyItem?m=((d=e.item)==null?void 0:d.value)||0:t.rightType===I.Direction&&(m=((D=this.level.getMoveCell(e.cell.x,e.cell.y,t.rightDirection).item)==null?void 0:D.value)||0),t.type){case S.Eq:s=c===m;break;case S.Ne:s=c!==m;break;case S.Gt:s=c>m;break;case S.Ge:s=c>=m;break;case S.Lt:s=c<m;break;case S.Le:s=c<=m;break}}t.logic===M.And?l=l&&s:t.logic===M.Or&&(l=l||s)}),l}remove(){const e=this.level.game.code.findIndex(l=>l===this.operatorEndIf);this.level.game.code.splice(e,1)}execute(e){return this.checkCondition(e)?e.currentLine+1:this.level.game.code.findIndex(l=>l===this.operatorEndIf)+1}createEndIf(){const e=new me(this.level);return e.operatorIf=this,this.operatorEndIf=e,e}serialize(e){return{type:o.If,id:this.id,conditions:this.conditions,operatorEndIf:this.operatorEndIf.id,object:e?this:void 0}}deserialize(e){this.id=e.id,this.operatorEndIfId=e.operatorEndIf,this.conditions=e.conditions}postDeserialize(){this.operatorEndIf=this.level.game.code.find(e=>e.id===this.operatorEndIfId)}}var $;(function(r){r.Printer="printer",r.Shredder="shredder",r.Hole="hole",r.Empty="empty"})($||($={}));class je extends C{constructor(){super(...arguments);this.slot=0,this.nearType=$.Printer,this.numberValue=0,this.slotValue=0}execute(e){const l=this.level.findNear([e.cell.x,e.cell.y],s=>s.getType()===this.nearType);let t=l[l.length-1];return(this.nearType===$.Printer||this.nearType===$.Shredder)&&(t=this.level.getMoveCell(t.x,t.y,p.Up)),e.slots[this.slot]=new G(e),e.slots[this.slot].setCell(t),e.currentLine+1}setSlot(e){this.slot=e}setNearType(e){this.nearType=e}serialize(e){return{type:o.Near,slot:this.slot,nearType:this.nearType,object:e?this:void 0}}deserialize(e){this.slot=e.slot,this.nearType=e.nearType}}class Ce extends C{execute(e){return e.pickupItem(),e.currentLine+1}serialize(e){return{type:o.Pickup,object:e?this:void 0}}deserialize(e){}}class xe extends C{execute(e){return e.say(this.hear,this.direction),e.currentLine+1}setSay(e){this.hear=e}setDirection(e){this.direction=e}serialize(e){return{type:o.Say,hear:this.hear,direction:this.direction,object:e?this:void 0}}deserialize(e){this.hear=e.hear,this.direction=e.direction}}class we extends C{constructor(e){super(e);this.direction=p.Down}setDirection(e){this.direction=e}execute(e){return e.take(this.direction),e.currentLine+1}serialize(e){return{type:o.Take,direction:this.direction,object:e?this:void 0}}deserialize(e){this.direction=e.direction}}var R;(function(r){r.Number="number",r.Slot="slot",r.MyItem="myItem"})(R||(R={}));class Se extends C{constructor(){super(...arguments);this.slot=0,this.variableType=R.Number,this.numberValue=0,this.slotValue=0}execute(e){return this.variableType===R.Number&&(e.slots[this.slotValue]=new X(e),e.slots[this.slotValue].setNumber(this.numberValue)),e.currentLine+1}setSlot(e){this.slot=e}setNumberValue(e){this.variableType=R.Number,this.numberValue=e}setSlotValue(e){this.variableType=R.Slot,this.slotValue=e}setMyItemValue(){this.variableType=R.MyItem}serialize(e){return{type:o.Variable,slot:this.slot,variableType:this.variableType,numberValue:this.numberValue,slotValue:this.slotValue,object:e?this:void 0}}deserialize(e){this.slot=e.slot,this.variableType=e.variableType,this.numberValue=e.numberValue,this.slotValue=e.slotValue}}class Ie extends C{constructor(){super(...arguments);this.value=0}execute(e){return e.write(this.value),e.currentLine+1}setLine(e){this.value=e}serialize(e){return{type:o.Write,value:this.value,object:e?this:void 0}}deserialize(e){this.value=e.value}}var N;(function(r){r.Run="Run",r.Stop="Stop"})(N||(N={}));class K{constructor(){this.code=[],this.state=N.Stop,this.speed=1e3}getLevel(){return this.level}setLevel(e){this.level=e}addOperator(e,l){let t;e===o.Pickup&&(t=new Ce(this.level)),e===o.Drop&&(t=new de(this.level)),e===o.End&&(t=new ue(this.level)),e===o.Goto&&(t=new ye(this.level)),e===o.Hear&&(t=new be(this.level)),e===o.If&&(t=new ge(this.level),this.code.splice(l,0,t.createEndIf())),e===o.Say&&(t=new xe(this.level)),e===o.Step&&(t=new ne(this.level)),e===o.Take&&(t=new we(this.level)),e===o.Variable&&(t=new Se(this.level)),e===o.Write&&(t=new Ie(this.level)),e===o.Foreach&&(t=new ve(this.level),this.code.splice(l,0,t.createEndForeach())),e===o.Give&&(t=new fe(this.level)),e===o.Near&&(t=new je(this.level)),e===o.Calc&&(t=new he(this.level)),t&&this.code.splice(l,0,t)}removeOperator(e){const l=this.code[e];this.code.splice(e,1),l.remove()}start(){this.state=N.Run,this.interval=window.setInterval(()=>{this.state===N.Run&&this.update()},this.speed)}stop(){clearInterval(this.interval),this.state=N.Stop}update(){!this.level.getCharacters().filter(e=>!e.isTerminated).length||(this.level.getCharacters().forEach(e=>{e.prepare()}),this.level.getCharacters().forEach(e=>{e.update()}),this.level.moveCharacters(),this.level.winCallback(this.level),this.level.getCharacters().length<2&&console.log("Wrong character"),console.log(this.level.cells),this.render())}deserializeCode(e){this.code=e.map(l=>{if(l.type===o.Drop){const t=new de(this.level);return t.deserialize(l),t}if(l.type===o.End){const t=new ue(this.level);return t.deserialize(l),t}if(l.type===o.Foreach){const t=new ve(this.level);return t.deserialize(l),t}if(l.type===o.EndForeach){const t=new pe(this.level);return t.deserialize(l),t}if(l.type===o.Give){const t=new fe(this.level);return t.deserialize(l),t}if(l.type===o.Goto){const t=new ye(this.level);return t.deserialize(l),t}if(l.type===o.Hear){const t=new be(this.level);return t.deserialize(l),t}if(l.type===o.If){const t=new ge(this.level);return t.deserialize(l),t}if(l.type===o.EndIf){const t=new me(this.level);return t.deserialize(l),t}if(l.type===o.Calc){const t=new he(this.level);return t.deserialize(l),t}if(l.type===o.Near){const t=new je(this.level);return t.deserialize(l),t}if(l.type===o.Pickup){const t=new Ce(this.level);return t.deserialize(l),t}if(l.type===o.Say){const t=new xe(this.level);return t.deserialize(l),t}if(l.type===o.Step){const t=new ne(this.level);return t.deserialize(l),t}if(l.type===o.Take){const t=new we(this.level);return t.deserialize(l),t}if(l.type===o.Variable){const t=new Se(this.level);return t.deserialize(l),t}if(l.type===o.Write){const t=new Ie(this.level);return t.deserialize(l),t}return console.error("Unknown operator type",l.type),null}),this.code.forEach(l=>l.postDeserialize())}deserialize(e){this.level||(this.level=new E(this)),this.level.deserialize(e.level),this.deserializeCode(e.code)}serialize(e=!1){return{level:this.level.serialize(e),code:this.code.map(l=>l.serialize(e)),state:this.state,speed:this.speed,object:e?this:void 0}}moveOperator(e,l){if(!this.code[e]||!this.code[l])return;const t=this.code[e];this.code.splice(e,1),this.code.splice(l,0,t)}render(){console.log("render"),this.renderCallback(this.serialize(!0))}}const L=80;function De(r){const e=r.game.object.level.cells,l=Object.keys(e).map(s=>{const i=ae(s),a=e[s];let u;return a instanceof B&&(u=null,a.getItem()&&(u=h(_,{children:[n(re,{fontSize:"small"})," ",a.item.isRandom&&r.game.state!==N.Run?"?":a.item.value]}))),a instanceof Y&&(u=n("div",{style:{width:"100%",height:"100%",backgroundColor:"black"}})),a instanceof Z&&(u="wall"),a instanceof W&&(u="printer"),a instanceof q&&(u="shredder"),n("div",{onClick:()=>r.onClick(s),style:{position:"absolute",left:i[0]*L,top:i[1]*L,width:L,height:L,borderStyle:"solid",borderColor:"black",borderWidth:1,display:"flex",alignItems:"center",justifyContent:"center"},children:u},s)}),t=r.game.object.level.getCharacters().sort((s,i)=>s.name>i.name?1:-1).map(s=>{const i=[s.cell.x,s.cell.y];return h("div",{style:{position:"absolute",opacity:s.isDead?0:1,transform:`translate(${i[0]*L}px, ${i[1]*L+10}px)`,transition:`all ${r.game.speed}ms ease-in`},children:[n(F,{fontSize:"small",style:{color:s.color}}),s.item?h(_,{children:["(",n(re,{fontSize:"small"})," ",s.item.value,")"]}):null]},s.name)});return h("div",{style:{position:"relative",width:r.game.level.width*L+L/2,height:r.game.level.height*L+L/2},children:[l,t]})}function Xe(r){return n(_,{children:Object.values(o).map(e=>n("div",{children:n(z,{onClick:()=>{r.game.object.addOperator(e,0),r.game.object.render()},children:`Add ${e}`})},e))})}const Ye=(r,e,l)=>h("span",{children:["Step:"," ",n(b,{IconComponent:null,value:r.object.type,onChange:t=>{t.target.value===x.Direction&&(r.object.setDirection([p.Down]),l.object.render()),t.target.value===x.Slot&&(r.object.setSlot(0),l.object.render())},variant:"standard",children:Object.values(x).map(t=>n(g,{value:t,children:t},t))}),r.object.type===x.Direction&&n(b,{IconComponent:null,value:r.object.directions,variant:"standard",multiple:!0,onChange:t=>{r.object.setDirection(t.target.value),l.object.render()},children:Object.values(p).map(t=>h(g,{value:t,children:[k(t),t]},t))}),r.object.type===x.Slot&&n(j,{type:"number",value:r.slot,variant:"standard",onChange:t=>{r.object.setSlot(parseInt(t.target.value)||0),l.object.render()}})]}),Ze=(r,e,l)=>h("span",{children:["Give:"," ",n(F,{fontSize:"small"}),n(te,{fontSize:"small"}),n(le,{fontSize:"small"})," ",n(b,{IconComponent:null,value:r.direction,variant:"standard",onChange:t=>{r.object.setDirection(t.target.value),l.object.render()},children:Object.values(p).map(t=>h(g,{value:t,children:[k(t),t]},t))})]}),Ke=(r,e,l)=>h("span",{children:["Take"," ",n(F,{fontSize:"small"}),n(ee,{fontSize:"small"}),n(le,{fontSize:"small"})," ",n(b,{IconComponent:null,value:r.direction,variant:"standard",onChange:t=>{r.object.setDirection(t.target.value),l.object.render()},children:Object.values(p).map(t=>h(g,{value:t,children:[k(t),t]},t))})]}),et=(r,e,l)=>h("span",{children:["Goto:"," ",n(b,{IconComponent:null,value:r.line,variant:"standard",onChange:t=>{r.object.setLine(parseInt(t.target.value.toString())),l.object.render()},children:Object.keys(l.code).map(t=>n(g,{value:t,children:t},t))})]}),tt=(r,e,l)=>h("span",{children:["If:"," ",r.conditions.map((t,s)=>h("span",{children:[!!s&&n(b,{IconComponent:null,value:t.logic,variant:"standard",onChange:i=>{r.object.conditions[s].logic=i.target.value,l.object.render()},children:Object.values(M).map(i=>n(g,{value:i,children:i},i))}),n(b,{IconComponent:null,value:t.leftType,onChange:i=>{r.object.conditions[s].leftType=i.target.value,l.object.render()},variant:"standard",children:Object.values(w).map(i=>n(g,{value:i,children:i},i))}),t.leftType==="direction"&&n(b,{IconComponent:null,value:t.leftDirection,variant:"standard",onChange:i=>{r.object.conditions[s].leftDirection=i.target.value,l.object.render()},children:Object.values(v).map(i=>h(g,{value:i,children:[k(i),i]},i))}),t.leftType==="slot"&&n(j,{type:"number",value:t.leftSlot,variant:"standard",onChange:i=>{r.object.conditions[s].leftSlot=parseInt(i.target.value)||0,l.object.render()}}),n(b,{IconComponent:null,value:t.type,variant:"standard",onChange:i=>{r.object.conditions[s].type=i.target.value,l.object.render()},children:Object.values(S).map(i=>n(g,{value:i,children:i},i))}),n(b,{IconComponent:null,value:t.rightType,onChange:i=>{r.object.conditions[s].rightType=i.target.value,l.object.render()},variant:"standard",children:Object.values(w).map(i=>n(g,{value:i,children:i},i))}),t.rightType==="number"&&n(j,{type:"number",value:t.rightNumber,variant:"standard",onChange:i=>{r.object.conditions[s].rightNumber=parseInt(i.target.value)||0,l.object.render()}}),t.rightType==="direction"&&n(b,{IconComponent:null,value:t.rightDirection,variant:"standard",onChange:i=>{r.object.conditions[s].rightDirection=i.target.value,l.object.render()},children:Object.values(v).map(i=>h(g,{value:i,children:[k(i),i]},i))}),t.rightType==="slot"&&n(j,{type:"number",value:t.rightSlot,variant:"standard",onChange:i=>{r.object.conditions[s].rightSlot=parseInt(i.target.value)||0}}),n(J,{size:"small",onMouseDown:()=>{const i=r.object.conditions;i.splice(s,1),r.object.conditions=i,l.object.render()},children:n(Re,{})}),s===r.conditions.length-1&&n(J,{size:"small",onMouseDown:()=>{r.object.conditions.push({logic:M.And,leftType:w.Slot,leftSlot:0,type:S.Eq,rightType:I.Number,rightSlot:0}),l.object.render()},children:n(Me,{})})]},s))]}),rt=()=>"Pickup",lt=()=>"Drop",st=(r,e,l)=>h("span",{children:["Near:"," ","slot",n(j,{type:"number",value:r.slot,variant:"standard",onChange:t=>{r.object.setSlot(parseInt(t.target.value)||0),l.object.render()}}),"=",n(b,{IconComponent:null,value:r.nearType,onChange:t=>{r.object.setNearType(t.target.value),l.object.render()},variant:"standard",children:Object.values($).map(t=>n(g,{value:t,children:t},t))})]}),it=(r,e,l)=>h("span",{children:["Variable"," ","slot",n(j,{type:"number",value:r.slot,variant:"standard",onChange:t=>{r.object.setSlot(parseInt(t.target.value)||0),l.object.render()}}),"=",n(b,{IconComponent:null,value:r.variableType,onChange:t=>{t.target.value==="number"&&r.object.setNumberValue(0),t.target.value==="myitem"&&r.object.setMyItemValue(),t.target.value==="slot"&&r.object.setSlotValue(0)},variant:"standard",children:Object.values(R).map(t=>n(g,{value:t,children:t},t))}),r.variableType==="number"&&n(j,{type:"number",value:r.numberValue,variant:"standard",onChange:t=>{r.object.setNumberValue(parseInt(t.target.value)||0),l.object.render()}}),r.variableType==="slot"&&n(j,{type:"number",value:r.slotValue,variant:"standard",onChange:t=>{r.object.setSlotValue(parseInt(t.target.value)||0),l.object.render()}})]}),nt=(r,e,l)=>h("span",{children:["Calc"," ","slot",n(j,{type:"number",value:r.slotResult,variant:"standard",onChange:t=>{r.object.slotResult=parseInt(t.target.value)||0,l.object.render()}}),"=",n(b,{IconComponent:null,value:r.operand1type,onChange:t=>{t.target.value==="number"&&r.object.setOperand1Number(0),t.target.value==="direction"&&r.object.setOperand1Direction(v.Up),t.target.value==="slot"&&r.object.setOperand1Slot(0),l.object.render()},variant:"standard",children:Object.values(y).map(t=>n(g,{value:t,children:t},t))}),r.operand1type===y.Number&&n(j,{type:"number",value:r.operand1NumberValue,variant:"standard",onChange:t=>{r.object.setOperand1Number(parseInt(t.target.value)||0),l.object.render()}}),r.operand1type===y.Direction&&n(b,{IconComponent:null,value:r.operand1DirectionValue,variant:"standard",onChange:t=>{r.object.setOperand1Direction(t.target.value),l.object.render()},children:Object.values(v).map(t=>h(g,{value:t,children:[k(t),t]},t))}),r.operand1type===y.Slot&&n(j,{type:"number",value:r.operand1SlotValue,variant:"standard",onChange:t=>{r.object.setOperand1Slot(parseInt(t.target.value)||0),l.object.render()}}),n(b,{IconComponent:null,value:r.operator,variant:"standard",onChange:t=>{r.operator=t.target.value},children:Object.values(O).map(t=>n(g,{value:t,children:t},t))}),n(b,{IconComponent:null,value:r.operand2type,onChange:t=>{t.target.value==="number"&&r.object.setOperand2Number(0),t.target.value==="direction"&&r.object.setOperand2Direction(v.Up),t.target.value==="slot"&&r.object.setOperand2Slot(0),l.object.render()},variant:"standard",children:Object.values(y).map(t=>n(g,{value:t,children:t},t))}),r.operand2type===y.Number&&n(j,{type:"number",value:r.operand2NumberValue,variant:"standard",onChange:t=>{r.object.setOperand2Number(parseInt(t.target.value)||0),l.object.render()}}),r.operand2type===y.Direction&&n(b,{IconComponent:null,value:r.operand2DirectionValue,variant:"standard",onChange:t=>{r.object.setOperand2Direction(t.target.value),l.object.render()},children:Object.values(v).map(t=>h(g,{value:t,children:[k(t),t]},t))}),r.operand2type===y.Slot&&n(j,{type:"number",value:r.operand2SlotValue,variant:"standard",onChange:t=>{r.object.setOperand2Slot(parseInt(t.target.value)||0),l.object.render()}})]}),at=(r,e,l)=>h("span",{children:["Say:"," ",n(j,{value:r.hear,variant:"standard",onChange:t=>{r.object.setSay(t.target.value),l.object.render()}}),n(b,{IconComponent:null,value:r.direction,variant:"standard",onChange:t=>{r.object.setDirection(t.target.value),l.object.render()},children:Object.values(p).map(t=>h(g,{value:t,children:[k(t),t]},t))})]}),ot=(r,e,l)=>h("span",{children:["Hear:"," ",n(j,{value:r.hear,variant:"standard",onChange:t=>{r.object.hear=t.target.value,l.object.render()}})]}),ct=(r,e,l)=>h("span",{children:["Foreach:"," ",n(b,{IconComponent:null,value:r.directions,variant:"standard",multiple:!0,onChange:t=>{r.object.setDirections(t.target.value),l.object.render()},children:Object.values(p).map(t=>h(g,{value:t,children:[k(t),t]},t))}),n(j,{type:"number",value:r.slotNumber,variant:"standard",onChange:t=>{r.object.slotNumber=parseInt(t.target.value)||0,l.object.render()}})]}),ht=()=>"End",dt=(r,e,l)=>h("span",{children:["Write"," ",n(j,{type:"number",value:r.value,variant:"standard",onChange:t=>{r.object.value=parseInt(t.target.value)||0,l.object.render()}})]});function ut(r,e,l,t){let s=null;return r.type==="step"&&(s=Ye(r,e,l)),r.type==="give"&&(s=Ze(r,e,l)),r.type==="take"&&(s=Ke(r,e,l)),r.type==="goto"&&(s=et(r,e,l)),r.type==="if"&&(s=tt(r,e,l)),r.type==="endif"&&(s="Endif"),r.type==="pickup"&&(s=rt()),r.type==="drop"&&(s=lt()),r.type==="near"&&(s=st(r,e,l)),r.type==="variable"&&(s=it(r,e,l)),r.type==="calc"&&(s=nt(r,e,l)),r.type==="say"&&(s=at(r,e,l)),r.type==="hear"&&(s=ot(r,e,l)),r.type==="foreach"&&(s=ct(r,e,l)),r.type==="endforeach"&&(s="Endforeach"),r.type==="end"&&(s=ht()),r.type==="write"&&(s=dt(r,e,l)),r.type==="endif"&&(t-=20),r.type==="endforeach"&&(t-=20),s=h("span",{children:[e,": ",n("span",{style:{paddingLeft:t},children:s}),n(J,{size:"small",onMouseDown:()=>{l.object.removeOperator(e),l.object.render()},children:n($e,{fontSize:"small"})})]},e),r.type==="if"&&(t+=20),r.type==="foreach"&&(t+=20),{result:s,intend:t}}const pt=Fe(({children:r})=>n("div",{children:r})),mt=Ue(({children:r})=>n("div",{children:r}));function vt(r){const[e,l]=T.exports.useState();T.exports.useEffect(()=>{const i=new K;i.deserialize(r.level),i.renderCallback=l,i.deserializeCode(JSON.parse(window.localStorage.getItem(`level${r.levelNumber}`))||[]),i.render()},[r.level]),e&&window.localStorage.setItem(`level${r.levelNumber}`,JSON.stringify(e.object.serialize().code));let t=0;const s=T.exports.useMemo(()=>e?e.code.map((i,a)=>{const u=ut(i,a,e,t);return t=u.intend,u.result}):[],[e==null?void 0:e.code]);return e?h(H,{container:!0,children:[h(H,{item:!0,md:6,children:[n("h2",{children:e.level.task}),n("h4",{children:e.state===N.Run&&e.level.winCallback(e.level.object)?"Win":null}),n(De,{game:e})]}),n(H,{item:!0,md:1,children:n(Xe,{game:e})}),n(H,{item:!0,md:5,children:h("div",{style:{paddingLeft:20},children:[n(mt,{onSortEnd:({oldIndex:i,newIndex:a},u)=>{u.ctrlKey||(e.object.moveOperator(i,a),e.object.render())},children:e.code.map((i,a)=>h(pt,{index:a,children:[e.object.level.getCharacters().filter(d=>d.currentLine===a).map(d=>n("span",{children:n(F,{fontSize:"small",style:{color:d.color}})},d.name)),s[a]]},i.object.id))}),h("div",{style:{paddingTop:20},children:["Speed:"," ",n(j,{variant:"standard",type:"number",value:1e3/e.speed,onChange:i=>{e.object.speed=1e3/(parseInt(i.target.value)||1),e.object.render()}})]}),h("div",{style:{display:"flex",gap:4},children:[n("div",{children:n(z,{variant:"contained",onClick:()=>{e.object.level.deserialize(r.level.level),e.object.render(),e.object.state===N.Run?e.object.stop():e.object.start()},disabled:t!==0,children:e.object.state===N.Run?"Stop":"Run"})}),n("div",{children:n(z,{variant:"contained",onClick:()=>A(JSON.stringify(e.object.serialize(),null,2)),children:"Copy"})}),n("div",{children:n(z,{variant:"contained",onClick:()=>{e.object.deserializeCode(r.level.code),e.object.render()},children:"Clear"})})]}),e.object.level.getCharacters().map(i=>{var a;return h("div",{children:[i.name," ",n("span",{style:{color:i.color},children:n(F,{fontSize:"small"})})," ",(a=i.slots)==null?void 0:a.map((u,d)=>h("span",{children:[u.getNumberValue()," "]},d))]},i.name)}),n("pre",{children:JSON.stringify(Object.values(e.object.level.cells).filter(i=>i.character).map(i=>{var a;return{name:(a=i.character)==null?void 0:a.name,line:i.character.currentLine,x:i.x,y:i.y}}),null,2)})]})})]}):null}const ft={level:{task:"Remove two boxes",width:5,height:7,cells:E.parseCells(`box|1 box|1 wall box|1 hole
empty empty wall box|2 empty
empty empty wall box|3 empty
empty empty wall box|4 printer
empty empty empty box|5 empty
hole hole
hole hole`,[{coordinates:[0,0],name:"first",color:"red"},{coordinates:[1,0],name:"second",color:"green"}]),winCallback:r=>Object.values(r.cells).filter(e=>e.item).length+r.getCharacters().filter(e=>!e.isDead&&e.item).length===5},code:[]},yt={level:{task:"Move boxes",width:5,height:5,cells:E.parseCells(`box|1 box|1 empty box|1 empty
        empty empty wall box|2 empty
        empty empty wall box|3 empty
        empty empty empty box|4 empty
        empty empty empty box|5 empty`,[{coordinates:[0,0],name:"first",color:"red"},{coordinates:[1,0],name:"second",color:"green"}]),winCallback:r=>Object.values(r.cells).filter(e=>e.item).length+r.getCharacters().filter(e=>!e.isDead&&e.item).length===5},code:[{type:o.Step,stepType:x.Direction,directions:[p.Left,p.Right,p.Up,p.Down]},{type:o.Step,stepType:x.Direction,directions:[p.Left,p.Right,p.Up,p.Down]},{type:o.Pickup},{type:o.Step,stepType:x.Direction,directions:[p.Left,p.Right,p.Up,p.Down]},{type:o.Step,stepType:x.Direction,directions:[p.Left,p.Right,p.Up,p.Down]},{type:o.Drop},{type:o.Goto,line:0}]},bt={level:{task:"Remove only box with 2",width:5,height:7,cells:E.parseCells(`empty empty empty empty empty
box|2|tag2 box|1|tag1 wall empty empty
empty empty wall empty empty
empty empty empty empty empty
empty empty empty empty empty
hole hole
hole hole`,[{coordinates:[0,0],name:"first",color:"red"},{coordinates:[1,0],name:"second",color:"green"}]),winCallback:r=>(Object.values(r.cells).find(e=>{var l;return((l=e.item)==null?void 0:l.tag)==="tag1"})||r.getCharacters().find(e=>{var l;return((l=e.item)==null?void 0:l.tag)==="tag1"}))&&!(Object.values(r.cells).find(e=>{var l;return((l=e.item)==null?void 0:l.tag)==="tag2"})||r.getCharacters().find(e=>{var l;return!e.isTerminated&&((l=e.item)==null?void 0:l.tag)==="tag2"}))},code:[]},gt={level:{task:"Diagonal boxes",width:5,height:7,cells:E.parseCells(`empty empty empty empty empty
box|1 box|1 box|1 box|1 box|1
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty`,[{coordinates:[1,1],name:"first",color:"red"},{coordinates:[2,1],name:"second",color:"green"},{coordinates:[3,1],name:"3",color:"yellow"},{coordinates:[4,1],name:"4",color:"blue"}]),winCallback:r=>[0,1,2,3,4].every(e=>r.cells[`${e}x${e+1}`].item)},code:[]},jt={level:{task:"Sort numbers",width:5,height:5,cells:E.parseCells(`empty empty empty empty empty
box|random box|0 box|random box|random box|random
empty empty empty empty empty
empty empty empty empty empty
empty empty empty empty empty`,[{coordinates:[0,1],name:"1",color:"purple"},{coordinates:[1,1],name:"2",color:"red"},{coordinates:[2,1],name:"3",color:"green"},{coordinates:[3,1],name:"4",color:"yellow"},{coordinates:[4,1],name:"5",color:"blue"}]),winCallback:r=>[0,1,2,3,4].every(e=>{var l,t,s,i;return e===0||((t=(l=r.cells[`${e}x1`].character)==null?void 0:l.item)==null?void 0:t.value)>=((i=(s=r.cells[`${e-1}x1`].character)==null?void 0:s.item)==null?void 0:i.value)})},code:[]},Ct={level:{task:"Print and shred 10 boxes",width:5,height:5,cells:E.parseCells(`empty empty empty empty empty
empty empty empty empty empty
empty printer shredder empty empty
empty empty empty empty empty
empty empty empty empty empty`,[{coordinates:[1,1],name:"first",color:"red"},{coordinates:[2,1],name:"second",color:"green"}]),winCallback:r=>r.cells["2x2"].shredded>=10},code:[]},xt={level:{task:"Print and shred 10 boxes (no move)",width:7,height:5,cells:E.parseCells(`hole hole hole hole hole hole hole
hole empty empty empty empty empty hole
hole printer hole hole hole shredder hole
hole hole hole hole hole hole hole
hole hole hole hole hole hole hole`,[{coordinates:[1,1],name:"1",color:"purple"},{coordinates:[2,1],name:"2",color:"red"},{coordinates:[3,1],name:"3",color:"green"},{coordinates:[4,1],name:"4",color:"yellow"},{coordinates:[5,1],name:"5",color:"blue"}]),winCallback:r=>r.cells["5x2"].shredded>=10},code:[]},P=[ft,yt,bt,gt,jt,Ct,xt];function wt(r){var D;const[e,l]=T.exports.useState(()=>{const c=new K;return c.deserialize(P[0]),c.renderCallback=m=>l(m),c.serialize(!0)}),[t,s]=T.exports.useState(!1),i=e.object.level.cells[t],[a,u]=T.exports.useState(0),d=JSON.stringify(e.object.serialize(),null,2);return h("div",{children:[h("div",{children:[n(b,{variant:"standard",value:a,onChange:c=>u(parseInt(c.target.value)),children:P.map((c,m)=>n(g,{value:m,children:c.level.task},m))}),n(z,{onClick:()=>{const c=new K;c.deserialize(P[a]),c.renderCallback=m=>l(m),c.render()},children:"Import"})]}),h("div",{children:[n(j,{label:"width",value:e.level.width,variant:"standard",onChange:c=>{e.object.level.changeSize(parseInt(c.target.value),e.level.height),e.object.render()}}),n(j,{label:"height",value:e.level.height,variant:"standard",onChange:c=>{e.object.level.changeSize(e.level.width,parseInt(c.target.value)),e.object.render()}}),n(z,{onClick:()=>{e.object.level.crop(e.object.level.width,e.object.level.height),e.object.render()},children:"Crop"})]}),n(De,{game:e,onClick:c=>s(c)}),h("div",{children:[h("div",{children:[n(z,{onClick:()=>A(JSON.stringify(e.object.level.serialize(!1),null,2)),children:"Copy cells"}),n(z,{onClick:()=>A(JSON.stringify(e.object.level.getCharacters(),null,2)),children:"Copy characters"}),n(z,{onClick:()=>A(d),children:"Copy level"})]}),n("pre",{children:n("div",{children:d})})]}),h(Ge,{open:t!==!1,onClose:()=>s(!1),children:[n(Pe,{children:t}),h(_e,{children:[n("div",{children:n(b,{value:i==null?void 0:i.getType(),onChange:c=>{const m=ae(t);let V;c.target.value===f.Empty&&(V=new B(e.object.level,m[0],m[1])),c.target.value===f.Wall&&(V=new Z(e.object.level,m[0],m[1])),c.target.value===f.Hole&&(V=new Y(e.object.level,m[0],m[1]),V.isEmpty=!0),c.target.value===f.Printer&&(V=new W(e.object.level,m[0],m[1]),V.isEmpty=!0),c.target.value===f.Shredder&&(V=new q(e.object.level,m[0],m[1]),V.isEmpty=!0),V&&e.object.level.addCell(m[0],m[1],V),e.object.render()},children:Object.values(f).map(c=>n(g,{value:c,children:c},c))})}),(i==null?void 0:i.getType())==="empty"?h("div",{children:["Item:"," ",n(se,{checked:!!(i==null?void 0:i.item),onChange:c=>{c.target.checked?i.setItem(new Q(0)):i.setItem(null),e.object.render()}})]}):null,(i==null?void 0:i.item)?n("div",{children:n(j,{label:"Item value",value:(D=i==null?void 0:i.item)==null?void 0:D.value,variant:"standard",onChange:c=>{i.item.value=parseInt(c.target.value)||0,e.object.render()}})}):null,(i==null?void 0:i.getType())==="empty"?h("div",{children:["Character:"," ",n(se,{checked:!!i.character,onChange:c=>{c.target.checked?(i.setCharacter(new ce(i,`${e.object.level.getCharacters().length+1}`)),i.character.color="green"):i.character=null,e.object.render()}})]}):null]})]})]})}const St=He({components:{MuiTextField:{styleOverrides:{root:{width:"50px","& input":{textAlign:"center"}}}},MuiSelect:{styleOverrides:{select:{paddingLeft:"24px"}}}}});function It(){const[r,e]=T.exports.useState(0),[l,t]=T.exports.useState(!1);return n(Ae,{theme:St,children:h("div",{className:"App",children:[n("h1",{children:"Open7BH"}),h(We,{value:l?1:0,onChange:(s,i)=>t(i===1),children:[n(ie,{label:"Game"}),n(ie,{label:"Editor"})]}),l?n(wt,{}):h(_,{children:[n("div",{children:n(b,{variant:"standard",value:r,onChange:s=>e(parseInt(s.target.value)),children:P.map((s,i)=>n(g,{value:i,children:s.level.task},i))})}),n(vt,{level:P[r],levelNumber:r})]})]})})}const Dt="modulepreload",Ve={},Vt="./",Nt=function(e,l){return!l||l.length===0?e():Promise.all(l.map(t=>{if(t=`${Vt}${t}`,t in Ve)return;Ve[t]=!0;const s=t.endsWith(".css"),i=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${i}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":Dt,s||(a.as="script",a.crossOrigin=""),a.href=t,document.head.appendChild(a),s)return new Promise((u,d)=>{a.addEventListener("load",u),a.addEventListener("error",d)})})).then(()=>e())},Lt=r=>{r&&r instanceof Function&&Nt(()=>import("./web-vitals.67dce932.js"),[]).then(({getCLS:e,getFID:l,getFCP:t,getLCP:s,getTTFB:i})=>{e(r),l(r),t(r),s(r),i(r)})},zt=qe.createRoot(document.getElementById("root"));zt.render(n(Be.StrictMode,{children:n(It,{})}));Lt();
